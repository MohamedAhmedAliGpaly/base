(function(t){function e(e){for(var o,i,r=e[0],c=e[1],l=e[2],u=0,d=[];u<r.length;u++)i=r[u],Object.prototype.hasOwnProperty.call(a,i)&&a[i]&&d.push(a[i][0]),a[i]=0;for(o in c)Object.prototype.hasOwnProperty.call(c,o)&&(t[o]=c[o]);p&&p(e);while(d.length)d.shift()();return s.push.apply(s,l||[]),n()}function n(){for(var t,e=0;e<s.length;e++){for(var n=s[e],o=!0,i=1;i<n.length;i++){var r=n[i];0!==a[r]&&(o=!1)}o&&(s.splice(e--,1),t=c(c.s=n[0]))}return t}var o={},i={app:0},a={app:0},s=[];function r(t){return c.p+"js/"+({}[t]||t)+"."+{"chunk-088773e2":"3f1da599","chunk-1e0a797d":"2fbb6668","chunk-2d0c8672":"f02dae82","chunk-34ced21d":"1321134f","chunk-61bf6aa6":"9c47cc42","chunk-780eaa6e":"ad0481a8","chunk-b03c951a":"3f9b104e","chunk-cec4b4a6":"2b539bc5","chunk-cef3167e":"32ec78ff"}[t]+".js"}function c(e){if(o[e])return o[e].exports;var n=o[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,c),n.l=!0,n.exports}c.e=function(t){var e=[],n={"chunk-088773e2":1,"chunk-1e0a797d":1,"chunk-61bf6aa6":1,"chunk-780eaa6e":1,"chunk-b03c951a":1};i[t]?e.push(i[t]):0!==i[t]&&n[t]&&e.push(i[t]=new Promise((function(e,n){for(var o="css/"+({}[t]||t)+"."+{"chunk-088773e2":"91b9cd94","chunk-1e0a797d":"d7e3f50c","chunk-2d0c8672":"31d6cfe0","chunk-34ced21d":"31d6cfe0","chunk-61bf6aa6":"a24f0a3d","chunk-780eaa6e":"c7a7d18c","chunk-b03c951a":"2acc496e","chunk-cec4b4a6":"31d6cfe0","chunk-cef3167e":"31d6cfe0"}[t]+".css",a=c.p+o,s=document.getElementsByTagName("link"),r=0;r<s.length;r++){var l=s[r],u=l.getAttribute("data-href")||l.getAttribute("href");if("stylesheet"===l.rel&&(u===o||u===a))return e()}var d=document.getElementsByTagName("style");for(r=0;r<d.length;r++){l=d[r],u=l.getAttribute("data-href");if(u===o||u===a)return e()}var p=document.createElement("link");p.rel="stylesheet",p.type="text/css",p.onload=e,p.onerror=function(e){var o=e&&e.target&&e.target.src||a,s=new Error("Loading CSS chunk "+t+" failed.\n("+o+")");s.code="CSS_CHUNK_LOAD_FAILED",s.request=o,delete i[t],p.parentNode.removeChild(p),n(s)},p.href=a;var f=document.getElementsByTagName("head")[0];f.appendChild(p)})).then((function(){i[t]=0})));var o=a[t];if(0!==o)if(o)e.push(o[2]);else{var s=new Promise((function(e,n){o=a[t]=[e,n]}));e.push(o[2]=s);var l,u=document.createElement("script");u.charset="utf-8",u.timeout=120,c.nc&&u.setAttribute("nonce",c.nc),u.src=r(t);var d=new Error;l=function(e){u.onerror=u.onload=null,clearTimeout(p);var n=a[t];if(0!==n){if(n){var o=e&&("load"===e.type?"missing":e.type),i=e&&e.target&&e.target.src;d.message="Loading chunk "+t+" failed.\n("+o+": "+i+")",d.name="ChunkLoadError",d.type=o,d.request=i,n[1](d)}a[t]=void 0}};var p=setTimeout((function(){l({type:"timeout",target:u})}),12e4);u.onerror=u.onload=l,document.head.appendChild(u)}return Promise.all(e)},c.m=t,c.c=o,c.d=function(t,e,n){c.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},c.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},c.t=function(t,e){if(1&e&&(t=c(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(c.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)c.d(n,o,function(e){return t[e]}.bind(null,o));return n},c.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return c.d(e,"a",e),e},c.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},c.p="",c.oe=function(t){throw console.error(t),t};var l=window["webpackJsonp"]=window["webpackJsonp"]||[],u=l.push.bind(l);l.push=e,l=l.slice();for(var d=0;d<l.length;d++)e(l[d]);var p=u;s.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"034f":function(t,e,n){"use strict";var o=n("64a9"),i=n.n(o);i.a},"56d7":function(t,e,n){"use strict";n.r(e);n("cadf"),n("551c"),n("f751"),n("097d");var o=n("2b0e"),i=n("8c4f");o["default"].use(i["a"]);var a=[{path:"/",name:"index",component:function(){return n.e("chunk-b03c951a").then(n.bind(null,"d504"))}},{path:"/UserInfo",name:"UserInfo",component:function(t){return n.e("chunk-61bf6aa6").then(function(){var e=[n("8f77")];t.apply(null,e)}.bind(this)).catch(n.oe)}},{path:"/UserPasswd",name:"UserPasswd",component:function(t){return n.e("chunk-2d0c8672").then(function(){var e=[n("5573")];t.apply(null,e)}.bind(this)).catch(n.oe)}},{path:"/WebMsg",name:"WebMsg",component:function(t){return n.e("chunk-cef3167e").then(function(){var e=[n("1e5b")];t.apply(null,e)}.bind(this)).catch(n.oe)}},{path:"/SysConfig",name:"SysConfig",component:function(t){return n.e("chunk-088773e2").then(function(){var e=[n("5f2a")];t.apply(null,e)}.bind(this)).catch(n.oe)}},{path:"/SysMenus",name:"SysMenus",component:function(t){return n.e("chunk-780eaa6e").then(function(){var e=[n("a6e8")];t.apply(null,e)}.bind(this)).catch(n.oe)}},{path:"/SysMenusAction",name:"SysMenusAction",component:function(t){return n.e("chunk-cec4b4a6").then(function(){var e=[n("ddf3")];t.apply(null,e)}.bind(this)).catch(n.oe)}},{path:"/SysUser",name:"SysUser",component:function(t){return n.e("chunk-1e0a797d").then(function(){var e=[n("6a53")];t.apply(null,e)}.bind(this)).catch(n.oe)}},{path:"/SysRole",name:"SysRole",component:function(t){return n.e("chunk-34ced21d").then(function(){var e=[n("10e1")];t.apply(null,e)}.bind(this)).catch(n.oe)}}],s=i["a"].prototype.push;i["a"].prototype.push=function(t){return s.call(this,t).catch((function(t){return t}))};var r=new i["a"]({base:"",routes:a}),c=r,l=n("8c89");function u(t){document.title=l["a"].title,t.prototype.$config=l["a"],t.prototype.$obj={scan:null,setTime:null,socket:null},t.prototype.$reg=function(t,e){var n=!1,o="",i={uname:/^[a-zA-Z][a-zA-Z0-9\_\@\-\*\&]{4,15}$/,tel:/^[1]\d{10}$/,email:/^([a-zA-Z0-9_-])+@([a-zA-Z0-9_-])+(\.[a-zA-Z0-9_-])+/,vcode:/^\d{4}$/,passwd:/^\w{6,16}$/};switch(t){case"uname":n=i.uname.test(e),o=n?"":"用户名英文开头5~16位！";break;case"tel":n=i.tel.test(e),o=n?"":"手机号码错误！";break;case"email":n=i.email.test(e),o=n?"":"邮箱帐号错误！";break;case"vcode":n=i.vcode.test(e),o=n?"":"验证码4位！";break;case"passwd":n=i.passwd.test(e),o=n?"":"密码为6~16位字符！";break}return!!n||o}}var d=n("bc3a"),p=n.n(d),f=n("d055"),g=n.n(f),h=n("5c96"),m=n.n(h),y=n("7f1a"),v=n.n(y),b=(n("8aa1"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("audio",{staticStyle:{display:"none"},attrs:{id:"msg"}}),t.update.show?n("div",{staticClass:"update_body",style:{backgroundColor:t.upDateColor.bg||t.$config.themeColor}},[n("div",{staticClass:"update_ct"},[n("div",{staticClass:"logo",style:{backgroundColor:t.upDateColor.logoBg}},[n("div")]),n("div",{staticClass:"loading",style:{backgroundImage:"linear-gradient(to right, "+t.upDateColor.loading+", "+t.upDateColor.loading+" "+t.update.loading+", "+t.upDateColor.loaded+" "+t.update.loading+", "+t.upDateColor.loaded+" 100%)"}}),n("div",{staticClass:"load_msg",domProps:{innerHTML:t._s(t.update.msg)}},[t._v("正在加载应用")]),n("div",{staticClass:"load_button"},[t.update.down?n("cube-button",{style:{backgroundColor:t.$config.themeColor},attrs:{inline:!0},on:{click:function(e){return t.updateDown()}}},[t._v("立即更新")]):t._e()],1)]),n("div",{staticClass:"update_logo",style:{color:t.upDateColor.copy}},[n("h1",[t._v(t._s(t.$config.title))]),n("h2",[t._v(t._s(t.$config.copy))])])]):t._e(),t.system.login_bg?n("el-container",{directives:[{name:"show",rawName:"v-show",value:!t.isLogin,expression:"!isLogin"}],staticClass:"login_body bgimg bgcover",style:{backgroundImage:"url("+t.$config.baseUrl+t.system.login_bg+")"}},[n("div",{staticClass:"login_ct"},[n("div",{staticClass:"logo flex_center"},[t.system.logo?n("div",{staticClass:"bgimg radius bgcover",style:{backgroundImage:"url("+t.$config.baseUrl+t.system.logo+")"}}):n("div",{staticClass:"bgimg radius"}),n("h1",{staticClass:"nowrap"},[t._v(t._s(t.system.title))])]),n("h2",[t._v("用户登录")]),n("div",{staticClass:"item"},[n("el-input",{attrs:{placeholder:"用户名/手机/邮箱"},model:{value:t.login.uname,callback:function(e){t.$set(t.login,"uname",e)},expression:"login.uname"}},[n("template",{slot:"prepend"},[n("label",{staticClass:"ico_input"},[n("i",{staticClass:"ico_mask ico_user"})])])],2)],1),n("div",{staticClass:"item"},[n("el-input",{attrs:{type:"password",placeholder:"请输入密码"},model:{value:t.login.passwd,callback:function(e){t.$set(t.login,"passwd",e)},expression:"login.passwd"}},[n("template",{slot:"prepend"},[n("label",{staticClass:"ico_input"},[n("i",{staticClass:"ico_mask ico_passwd"})])])],2)],1),n("div",{staticClass:"item"},[n("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary",disabled:t.login.dis},on:{click:function(e){return t.loginSub()}}},[t._v(t._s(t.login.subText))])],1),n("div",{staticClass:"copy nowrap"},[t._v("© "+t._s(t.system.copy)+" license  版本："+t._s(t.$config.version))])])]):t._e(),n("el-container",{directives:[{name:"show",rawName:"v-show",value:t.isLogin,expression:"isLogin"}],staticClass:"app_body"},[n("el-aside",{staticClass:"app_menus",style:{width:t.isCollapse?"64px":"200px"}},[n("div",{staticClass:"app_img",on:{click:function(e){return t.openUrl("ico_mask ico_userinfo","UserInfo","11","基本资料",!0)}}},[t.uinfo.img?n("div",{staticClass:"bgimg bgcover",style:{backgroundImage:"url("+t.$config.baseUrl+t.uinfo.img+")"}}):n("div",{staticClass:"bgimg"}),n("p",{staticClass:"nowrap"},[t._v(t._s(t.uinfo.nickname||"昵称")+"("+t._s(t.uinfo.name||"姓名")+")")])]),n("el-menu",{attrs:{"default-active":t.defaultMenu,collapse:t.isCollapse,"unique-opened":""}},t._l(t.menus,(function(e,o){return n("el-submenu",{key:o,attrs:{index:""+e.id}},[n("template",{slot:"title"},[n("i",{class:e.ico}),n("span",[t._v(t._s(e.title))])]),t._l(e.menus,(function(e,o){return n("div",{key:o},[0==e.menus.length?n("el-menu-item",{attrs:{index:""+e.id},on:{click:function(n){return t.openUrl(e.ico,e.url,""+e.id,e.title)}}},[t._v(t._s(e.title))]):n("el-submenu",{attrs:{index:""+e.id}},[n("template",{slot:"title"},[n("span",[t._v(t._s(e.title))])]),t._l(e.menus,(function(e,o){return n("el-menu-item",{key:o,attrs:{index:""+e.id},on:{click:function(n){return t.openUrl(e.ico,e.url,""+e.id,e.title)}}},[t._v(t._s(e.title))])}))],2)],1)}))],2)})),1),n("div",{staticClass:"app_version nowrap"},[t._v("版本："+t._s(t.$config.version))])],1),n("el-container",[n("el-header",{staticClass:"app_top flex"},[n("el-tooltip",{staticClass:"logo",attrs:{effect:"dark",content:"点击”收缩/展开“左侧菜单",placement:"bottom-start"}},[n("a",{on:{click:function(e){return t.hideMenus()}}},[n("i",{staticClass:"el-icon-menu"}),t._v(" "+t._s(t.$storage.getItem("MenuName")||t.system.title))])]),n("div",{staticClass:"flex"},[n("div",{staticClass:"menu_ico flex_center"},[n("el-badge",{attrs:{value:t.msgNew}},[n("i",{staticClass:"c_main el-icon-chat-line-round",on:{click:function(e){return t.openUrl("ico_mask ico_msg","WebMsg","4","我的消息",!0)}}})])],1),n("div",{staticClass:"uinfo"},[t._v(t._s(t.uinfo.position)+"("+t._s(t.uinfo.uname||"系统用户")+")  |  "),n("span",{on:{click:function(e){return t.logout()}}},[t._v("退出")])])])],1),n("el-main",{staticClass:"app_main"},[n("router-view"),n("div",{staticClass:"app_copy"},[t._v("所属："+t._s(t.system.title)+"  © "+t._s(t.system.copy)+"  版本："+t._s(t.$config.version))])],1)],1)],1)],1)}),w=[],k=(n("7f7f"),n("20d6"),n("9060")),C={name:"APP",data:function(){return{isLogin:!1,isCollapse:!1,defaultMenu:"",update:{show:!1,os:"",down:!1,loading:"0%",msg:"检测更新",file:"",total:0},upDateColor:l["a"].upDateColor,login:{uname:"",passwd:"",subText:"登录",dis:!1},system:{},uinfo:{},menus:[],msgNew:0,msgInterval:null}},mounted:function(){var t=this;try{plus,k["a"].isPlus((function(){plus.screen.lockOrientation("portrait-primary"),plus.navigator.setStatusBarStyle("dark"),plus.navigator.setStatusBarBackground(l["a"].themeColor);var e=0,n=plus.webview.currentWebview();plus.key.addEventListener("backbutton",(function(){n.canBack((function(n){n.canBack?(t.$router.go(-1),t.$obj.scan&&t.$obj.scan.close()):(e>0&&plus.runtime.quit(),t.$createToast({txt:"再按一次退出应用!"}).show(),e++,setTimeout((function(){e=0}),2e3))}))}),!1),l["a"].update&&t.isUpdate()}))}catch(n){window.history.pushState("forward",null,"#"),window.history.forward(1),window.addEventListener("popstate",(function(e){t.$router.go(-1)})),document.body.ontouchstart=function(){document.createElement("audio")}}this.isCollapse="true"==this.$storage.getItem("isCollapse"),this.defaultMenu=this.$storage.getItem("defaultMenu")?this.$storage.getItem("defaultMenu"):"3",this.getConfig();var e=this.$storage.getItem("token");e&&(this.isLogin=!0,this.token((function(e){if(0!=e.data.code)return t.logout();t.getMenus(),t.uinfo=e.data.uinfo,t.openSocket(),document.addEventListener("visibilitychange",(function(){if("hidden"==document.visibilityState){var e=(new Date).getTime();t.$storage.setItem("HiddenTime",e)}else{var n=t.$storage.getItem("HiddenTime"),o=(new Date).getTime();(o-n)/1e3>10?(t.$obj.socket.close(),setTimeout((function(){t.openSocket()}),3e3)):console.log("保持链接")}}))})))},methods:{openSocket:function(){var t=this,e=this.$storage.getItem("token");e&&(this.$obj.socket=new WebSocket(l["a"].socketServer+"?token="+e),this.$obj.socket.onopen=function(){console.log("消息系统"),clearInterval(t.heartbeat),t.heartbeat=setInterval((function(){t.$obj.socket&&t.$obj.socket.send(JSON.stringify({type:""}))}),1e4),t.$obj.socket.send(JSON.stringify({type:"newMsg"})),clearInterval(t.msgInterval),t.msgInterval=setInterval((function(){t.$obj.socket.send(JSON.stringify({type:"newMsg"})),t.$obj.socket.send(JSON.stringify({type:"getMsg"}))}),l["a"].msgNew)},this.$obj.socket.onmessage=function(e){var n=JSON.parse(e.data);0==n.code&&"system"==n.type?(k["a"].notify(n.title,n.content,(function(e){n.id&&t.closeMsg(n.id),e.close()})),t.$obj.socket.send(JSON.stringify({type:"newMsg"}))):0==n.code&&"newMsg"==n.type?(t.msgNew=n.num,t.$storage.setItem("msgNew",n.num)):0==n.code&&"getMsg"==n.type&&n.title&&k["a"].notify(n.title,n.content,(function(e){n.id&&t.closeMsg(n.id),e.close()}))},this.$obj.socket.onclose=function(){console.log("关闭消息"),clearInterval(t.msgInterval),t.$obj.socket=null})},closeMsg:function(t){var e=this;this.$ajax.post(this.$config.apiUrl+"UserMain/msgNewState","token="+this.$storage.getItem("token")+"&id="+t).then((function(t){e.$obj.socket.send(JSON.stringify({type:"newMsg"}))}))},getConfig:function(){var t=this;this.$ajax.post(this.$config.apiUrl+"index/getConfig").then((function(e){var n=e.data;0==n.code&&(t.system=n.list)}))},getMenus:function(){var t=this;this.$ajax.post(this.$config.apiUrl+"UserMain/getMenus","token="+this.$storage.getItem("token")).then((function(e){var n=e.data;0==n.code&&(t.menus=n.menus)}))},openUrl:function(t,e,n,o,i){if(this.$storage.setItem("MenuName",o),this.$storage.setItem("defaultMenu",n),"3"!=n){var a=JSON.parse(this.$storage.getItem("Menus")||"[]"),s={ico:t,url:e,index:n,name:o},r=a.findIndex((function(t){return JSON.stringify(t)==JSON.stringify(s)}));r>=0&&a.splice(r,1),a.push({ico:t,url:e,index:n,name:o}),this.$storage.setItem("Menus",JSON.stringify(a))}this.$router.push(e),i&&setTimeout((function(){window.location.reload()}),300)},loginSub:function(){var t=this,e=this.login.uname,n=this.login.passwd;return!(!e||!n)&&(1!=this.$reg("uname",e)&&1!=this.$reg("tel",e)&&1!=this.$reg("email",e)?this.$message.error("请输入帐号/手机/邮箱！"):1!=this.$reg("passwd",n)?this.$message.error(this.$reg("passwd",n)):(this.login.subText="正在登录",this.login.dis=!0,void this.$ajax.post(this.$config.apiUrl+"user/login","uname="+e+"&passwd="+n).then((function(e){t.login.subText="登录",t.login.dis=!1;var n=e.data;0!=n.code?t.$message.error(n.msg):(t.isLogin=!0,t.$storage.setItem("token",n.token),t.$storage.setItem("uinfo",JSON.stringify(n.uinfo)),window.location.reload())}))))},logout:function(){this.isLogin=!1,this.$storage.setItem("token",""),this.$storage.setItem("uinfo","")},token:function(t){this.$ajax.post(this.$config.apiUrl+"user/token","token="+this.$storage.getItem("token")).then(t)},hideMenus:function(){this.isCollapse=!this.isCollapse,this.$storage.setItem("isCollapse",this.isCollapse)},isUpdate:function(){var t=this;this.update.os=plus.os.name,this.$ajax.post(this.$config.apiUrl+"index/appUpdate","os="+this.update.os).then((function(e){var n=e.data;if(0!=n.code)return!1;plus.runtime.getProperty(plus.runtime.appid,(function(e){if(n.version==e.version)return!1;t.update.show=!0,t.update.down=!0,t.update.msg="新版本: "+n.version+"&nbsp;&nbsp;大小: "+(n.size/1024/1024).toFixed(2)+"MB",t.update.file=t.$config.baseUrl+n.file,t.update.total=n.size}))}))},updateDown:function(){var t=this;if(this.update.down=!1,this.update.msg="开始下载",this.update.loading="0%","iOS"==this.update.os)this.update.msg="请在桌面查看安装进度",window.open(this.update.file),setTimeout((function(){plus.runtime.quit()}),5e3);else{var e=plus.downloader.createDownload(this.update.file,{filename:"_doc/download/",timeout:30},(function(e,n){200==n?plus.runtime.install(e.filename,{force:!0},(function(){plus.runtime.restart()}),(function(e){t.$createToast({txt:"安装失败"}).show()})):(t.update.down=!0,t.update.msg="下载失败")}));e.start(),e.addEventListener("statechanged",(function(e,n){var o=parseInt(e.downloadedSize/t.update.total*100);t.update.loading=o+"%",t.update.msg="正在下载："+t.update.loading,o>=100&&(t.update.msg="下载完成，安装并重启")}))}}}},_=C,$=(n("034f"),n("2877")),S=Object($["a"])(_,b,w,!1,null,null,null),x=S.exports;o["default"].prototype.$ajax=p.a,o["default"].prototype.$storage=window.localStorage,o["default"].prototype.$qrcode=g.a,o["default"].prototype.$G2=v.a,o["default"].use(u),o["default"].use(m.a),o["default"].config.productionTip=!1,new o["default"]({router:c,render:function(t){return t(x)}}).$mount("#app")},"5faa":function(t,e,n){"use strict";var o=n("b743"),i=n.n(o);i.a},"64a9":function(t,e,n){},"8aa1":function(t,e,n){},"8c89":function(t,e,n){"use strict";var o="https://api.webmis.vip/";e["a"]={title:"WebMIS",version:"v1.0.0",baseUrl:o,apiUrl:o+"admin/",themeColor:"#6FB737",copy:"Copyright © WebMIS.VIP 2019",statusBar:{height:"env(safe-area-inset-top)",color:"#333",bgColor:"#FFF"},update:!1,upDateColor:{bg:"",logoBg:"#FFF",loading:"#FFF",loaded:"#666",copy:"#333"},upIosUrl:"itms-apps://itunes.apple.com/cn/app/tao-bao-sui-shi-sui-xiang/id387682726?mt=8",amapKey:"d956f0c3e15489a1b5bf291e5d133c8a",socketServer:"wss://webmis.vip/wss",msgRead:1e3,msgNew:3e5,msgContent:"title",msgBrowser:!1}},9060:function(t,e,n){"use strict";n("386d"),n("7f7f");var o=n("2b0e"),i=n("8c89"),a=n("8f9b"),s=n.n(a),r=n("bc3a"),c=n.n(r),l=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"notify_body",style:{backgroundColor:t.bgColor,color:t.color}},[n("div",{staticClass:"notify_title flex"},[n("div",{staticClass:"logo"}),n("h2",{staticClass:"nowrap"},[t._v(t._s(t.title))]),n("div",{staticClass:"close"})]),t.content?n("div",{staticClass:"notify_content",domProps:{innerHTML:t._s(t.content)}}):t._e()])},u=[],d={name:"Notify",props:{title:{type:String,default:"消息"},content:{type:String,default:""},bgColor:{type:String,default:"#FFF"},color:{type:String,default:"#333"}},data:function(){return{}},mounted:function(){},methods:{}},p=d,f=(n("5faa"),n("2877")),g=Object(f["a"])(p,l,u,!1,null,"840c12a2",null),h=g.exports,m={install:function(t){var e=function(t){t.style.transition="all .3s ease",t.style.transform="translate(0, 0)",t.style.opacity="1"},n=function(t,e){t.style.transition="all .3s ease",t.style.transform="translate(0, -100%)",t.style.opacity="0",setTimeout((function(){e.removeChild(t)}),300)};t.prototype.$msgNotify=function(o){var i=t.extend(h),a=new i,s=document.createElement("div");a.$mount(s),a.title=o.title||"标题",a.content=o.content||"",a.color=o.color||"#333",a.bgColor=o.bgColor||"rgba(255,255,255,.9)",o.delay=o.delay||5e3,o.onClick=o.onClick||function(){};var r=document.getElementById("notifyBody");r||(r=document.createElement("div"),r.setAttribute("id","notifyBody"),r.setAttribute("style","position: fixed; z-index: 9999; width: 100%; max-width: 360px; top: 10px; left: 0; right: 0; margin: auto;")),document.body.appendChild(r),r.appendChild(a.$el),setTimeout((function(){e(a.$el)}),300),a.$el.stime=setTimeout((function(){n(a.$el,r)}),o.delay),a.$el.onclick=function(){o.onClick(this)},a.$el.close=function(){clearTimeout(a.$el.stime),n(a.$el,r)}}}},y=m;o["default"].use(y),s.a.initAMapApiLoader({key:i["a"].amapKey,plugin:["AMap.Geolocation","PlaceSearch"],v:"1.4.15"});e["a"]={isPlus:function(t){document.addEventListener("plusready",t,!1)},notify:function(t,e,n){i["a"].msgBrowser&&window.Notification&&"denied"!==Notification.permission&&Notification.requestPermission((function(n){setTimeout((function(){new Notification(t,{body:e})}),i["a"].msgRead)})),setTimeout((function(){o["default"].prototype.$msgNotify({title:t,content:e,delay:1e4,onClick:n})}),i["a"].msgRead),0!=i["a"].msgRead&&c.a.post(i["a"].apiUrl+"index/baiduToken").then((function(n){var o=document.getElementById("msg"),a="title"==i["a"].msgContent?t:e;o.src="//tsn.baidu.com/text2audio?lan=zh&ctp=1&cuid=1&tex="+a+"&tok="+n.data.token,setTimeout((function(){try{if("iOS"==plus.os.name){var t=plus.ios.importClass("AVAudioSession"),e=t.sharedInstance();e.setCategoryerror("AVAudioSessionCategoryPlayback",null),e.setActiveerror("YES",null);var n=plus.ios.importClass("AVSpeechSynthesizer"),i=plus.ios.importClass("AVSpeechUtterance"),s=plus.ios.import("AVSpeechSynthesisVoice"),r=new n,c=s.voiceWithLanguage("zh-CN"),l=i.speechUtteranceWithString(a);l.setVoice(c),r.speakUtterance(l)}else o.play()}catch(u){o.play()}}),i["a"].msgRead)}))},pay:function(t,e,n,o,i){var a="";for(var s in n)a+=s+"="+n[s]+"&";try{"alipay"==t?a+="type=app":"wxpay"==t&&(a+="type=APP"),plus.payment.getChannels((function(n){var s=null;for(var r in n)n[r].id==t&&(s=n[r]);c.a.post(e,a).then((function(t){var e=t.data;0==e.code?plus.payment.request(s,e.data,o,i):console.log(e.msg)}))}),(function(t){console.log("支付通道: "+t.message)}))}catch(r){console.log("H5方式: "+t)}},geoLocation:function(t,e){try{plus.geolocation.getCurrentPosition((function(e){var n={};n.province=e.address.province,n.city=e.address.city,n.latitude=e.coords.latitude,n.longitude=e.coords.longitude,window.localStorage.setItem("GeoLocation",JSON.stringify(n)),t(n)}),e)}catch(n){setTimeout((function(){AMap.service(["AMap.Geolocation"],(function(){var n=new AMap.Geolocation({enableHighAccuracy:!1,timeout:5e3});n.getCityInfo((function(o,i){var a={};a.province=i.province,a.city=i.city,n.getCurrentPosition((function(n,o){o&&o.position?(a.latitude=o.position.lat,a.longitude=o.position.lng,window.localStorage.setItem("GeoLocation",JSON.stringify(a)),t(a)):e(n)}))}))}))}),500)}},getAddress:function(t,e,n){setTimeout((function(){AMap.service(["AMap.PlaceSearch"],(function(){var o=window.localStorage.getItem("GeoLocation");o=o?JSON.parse(o):{city:"昆明市"};var i=new AMap.PlaceSearch({city:o.city});i.search(t,(function(t,o){o&&o.poiList?e(o.poiList.pois):n(t)}))}))}),500)},camera:function(t,e){try{var n=plus.camera.getCamera();n.captureImage((function(e){plus.io.resolveLocalFileSystemURL(e,(function(n){t(e,n)}),(function(t){console.log("读取拍照失败")}))}),e)}catch(i){var o=document.createElement("input");o.setAttribute("type","file"),o.setAttribute("style","visibility: hidden"),document.body.appendChild(o),o.click(),o.onchange=function(){t(o.files[0])}}},photo:function(t,e,n){n=n||!0;try{plus.gallery.pick((function(e){var n=e.files,o=[],i=null;for(var a in n)plus.io.resolveLocalFileSystemURL(n[a],(function(e){e.file((function(e){o.push(e),clearTimeout(i),i=setTimeout((function(){t(o)}),300)}))}),(function(t){console.log("读取文件: "+t.message)}))}),e,{filter:"image",multiple:n})}catch(i){var o=document.createElement("input");o.setAttribute("type","file"),o.setAttribute("style","visibility: hidden"),n&&o.setAttribute("multiple","multiple"),document.body.appendChild(o),o.click(),o.onchange=function(){t(o.files)}}},readerCompress:function(t,e,n){var o=this;try{var i=new plus.io.FileReader;i.readAsDataURL(t),i.onloadend=function(){e.ext||("image/jpeg"==t.type?e.ext="jpg":"image/png"==t.type?e.ext="png":"image/gif"==t.type&&(e.ext="gif")),o.compressImage(this.result,e,n)}}catch(s){var a=new FileReader;a.readAsDataURL(t),a.onloadend=function(){e.ext||("image/jpeg"==t.type?e.ext="jpg":"image/png"==t.type?e.ext="png":"image/gif"==t.type&&(e.ext="gif")),o.compressImage(this.result,e,n)}}},compressImage:function(t,e,n){var o=e.width||0,i=e.height||0,a=e.cut||!0,s=e.quality||.8,r=e.ext||"jpg",c={jpg:"image/jpeg",png:"image/png",gif:"image/gif"},l=1,u=1,d=0,p=0,f=1,g=l/u,h=document.createElement("canvas"),m=h.getContext("2d"),y=new Image;y.src=t,y.onload=function(){g=this.width/this.height,o>0&&0==i?(l=o<this.width?o:this.width,u=o<this.width?Math.round(o/g):Math.round(this.width/g),o=l,i=u):0==o&&i>0?(l=i<this.height?Math.round(i*g):Math.round(this.height*g),u=i<this.height?i:this.height,o=l,i=u):0==o&&0==i?(l=this.width,u=this.height,o=l,i=u):(f=o/i,g>f?o<this.width?(l=a?Math.round(i*g):o,u=a?i:Math.round(o/g)):(l=a?Math.round(this.height*g):this.width,u=a?this.height:Math.round(this.width/g)):i<this.height?(l=a?o:Math.round(i*g),u=a?Math.round(o/g):i):(l=a?this.width:Math.round(this.height*g),u=a?Math.round(this.width/g):this.height)),h.width=o,h.height=i,d=Math.round(o-l)/2,p=Math.round(i-u)/2,m.drawImage(this,d,p,l,u);var t=h.toDataURL(c[r],s);n(t)}},video:function(t,e){try{var n=plus.camera.getCamera();n.startVideoCapture((function(e){plus.io.resolveLocalFileSystemURL(e,(function(n){t(e,n)}),(function(t){console.log("读取录像失败")}))}),e)}catch(o){console.log("录像")}},audio:function(t,e,n){try{t.record({filename:"_doc/audio/"},(function(t){plus.io.resolveLocalFileSystemURL(t,(function(n){e(t,n)}),(function(t){console.log("读取音频失败")}))}),n)}catch(o){console.log("录音")}},uploader:function(t,e,n,o){try{for(var i=plus.uploader.createUpload(t,{method:"POST"},n),a=0;a<e.length;a++)"file"==e[a].type?i.addFile(e[a].val,{key:e[a].key}):"data"==e[a].type&&i.addData(e[a].key,e[a].val);i.addEventListener("statechanged",o,!1),i.start()}catch(s){console.log("上传文件")}},cacheClear:function(){try{plus.io.resolveLocalFileSystemURL("_doc/",(function(t){return t.removeRecursively()}),(function(t){console.log("清理缓存失败")}))}catch(t){console.log("清理缓存")}}}},b743:function(t,e,n){}});
//# sourceMappingURL=app.ad050d25.js.map