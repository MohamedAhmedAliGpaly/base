(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6f51718a"],{"172b":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("Action",{attrs:{url:"SysPerm"},on:{action:t.openAction}}),a("el-row",{staticClass:"body"},[a("el-table",{attrs:{data:t.pageData.list,stripe:""},on:{"selection-change":t.getSelect}},[a("el-table-column",{attrs:{type:"selection",width:"45"}}),a("el-table-column",{attrs:{prop:"uid",label:"UID",width:"170"}}),a("el-table-column",{attrs:{label:"个人信息",width:"160"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-popover",{attrs:{trigger:"hover",placement:"top"}},[a("p",[t._v("职务: "+t._s(e.row.position||"无"))]),a("p",[t._v("昵称: "+t._s(e.row.nickname||"无"))]),a("p",[t._v("姓名: "+t._s(e.row.name||"无"))]),a("p",[t._v("性别: "+t._s(e.row.gender||"无"))]),a("p",[t._v("生日: "+t._s(e.row.birthday||"无"))]),a("p",[t._v("年龄: "+t._s(e.row.age||"")+"岁")]),a("div",{attrs:{slot:"reference"},slot:"reference"},[a("el-tag",{attrs:{size:"medium"}},[t._v(t._s(e.row.tel||e.row.email||e.row.uname))])],1)])]}}])}),a("el-table-column",{attrs:{label:"登录时间",width:"160"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-popover",{attrs:{trigger:"hover",placement:"top"}},[a("p",[t._v("注册: "+t._s(e.row.rtime||"无"))]),a("p",[t._v("修改: "+t._s(e.row.utime||"无"))]),a("p",[t._v("登录: "+t._s(e.row.ltime||"无"))]),a("div",{attrs:{slot:"reference"},slot:"reference"},[a("el-tag",{attrs:{size:"medium"}},[t._v(t._s(e.row.ltime||"无"))])],1)])]}}])}),a("el-table-column",{attrs:{label:"状态",width:"70"},scopedSlots:t._u([{key:"default",fn:function(e){return[1==e.row.state?a("el-tag",{attrs:{type:"success"}},[t._v("正常")]):a("el-tag",{attrs:{type:"danger"}},[t._v("禁用")])]}}])}),a("el-table-column",{attrs:{label:"后台",width:"70"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-switch",{attrs:{"inactive-color":"#CCC"},on:{change:function(a){return t.setState("admin",e.row)}},model:{value:e.row.state_admin,callback:function(a){t.$set(e.row,"state_admin",a)},expression:"scope.row.state_admin"}})]}}])}),a("el-table-column",{attrs:{label:"APP",width:"70"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-switch",{attrs:{"inactive-color":"#CCC"},on:{change:function(a){return t.setState("app",e.row)}},model:{value:e.row.state_app,callback:function(a){t.$set(e.row,"state_app",a)},expression:"scope.row.state_app"}})]}}])}),a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.perm?a("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(a){return t.eidtPerm(e.row.uid,e.row.perm,e.row.role)}}},[t._v("专属权限")]):a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){return t.eidtPerm(e.row.uid,e.row.perm,e.row.role)}}},[t._v("角色权限")])]}}])})],1)],1),a("el-row",{staticClass:"page"},[a("el-pagination",{attrs:{background:"",layout:"prev, pager, next, total",total:t.pageData.total,"current-page":t.pageData.page,"page-size":t.pageData.limit},on:{"current-change":t.page}})],1),a("el-dialog",{attrs:{title:"搜索",visible:t.seaData.show,center:"",width:"420px"},on:{"update:visible":function(e){return t.$set(t.seaData,"show",e)}}},[a("el-form",{attrs:{model:t.seaData.form,"label-width":t.LabelWidth}},[a("el-form-item",{attrs:{label:"账号"}},[a("el-input",{attrs:{placeholder:"用户名/手机号码/邮箱"},model:{value:t.seaData.form.uname,callback:function(e){t.$set(t.seaData.form,"uname",e)},expression:"seaData.form.uname"}})],1)],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.subSea()}}},[t._v("搜 索")])],1)],1),a("el-dialog",{attrs:{title:"添加",visible:t.addData.show,center:"",width:"420px","close-on-click-modal":!1},on:{"update:visible":function(e){return t.$set(t.addData,"show",e)}}},[a("el-form",{attrs:{model:t.addData.form,"label-width":t.LabelWidth}},[a("el-form-item",{attrs:{label:"手机"}},[a("el-input",{attrs:{maxlength:"11",placeholder:"输入手机号码"},model:{value:t.addData.form.tel,callback:function(e){t.$set(t.addData.form,"tel",e)},expression:"addData.form.tel"}})],1),a("el-form-item",{attrs:{label:"密码"}},[a("el-input",{attrs:{maxlength:"16",placeholder:"默认密码"},model:{value:t.addData.form.passwd,callback:function(e){t.$set(t.addData.form,"passwd",e)},expression:"addData.form.passwd"}})],1)],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.subAdd()}}},[t._v("添 加")])],1)],1),a("el-dialog",{attrs:{title:"编辑",visible:t.editData.show,center:"",width:"420px","close-on-click-modal":!1},on:{"update:visible":function(e){return t.$set(t.editData,"show",e)}}},[a("el-form",{attrs:{model:t.editData.form,"label-width":t.LabelWidth}},[a("el-form-item",{attrs:{label:"手机"}},[a("el-input",{attrs:{maxlength:"11",placeholder:"输入手机号码"},model:{value:t.editData.form.tel,callback:function(e){t.$set(t.editData.form,"tel",e)},expression:"editData.form.tel"}})],1),a("el-form-item",{attrs:{label:"密码"}},[a("el-input",{attrs:{maxlength:"16",placeholder:"重置密码"},model:{value:t.editData.form.passwd,callback:function(e){t.$set(t.editData.form,"passwd",e)},expression:"editData.form.passwd"}})],1)],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.subEdit()}}},[t._v("保 存")])],1)],1),a("el-dialog",{attrs:{title:"删除",visible:t.delData.show,center:"",width:"320px"},on:{"update:visible":function(e){return t.$set(t.delData,"show",e)}}},[a("div",[t._v("是否删除已选择数据？")]),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.subDel()}}},[t._v("彻底删除")])],1)]),a("el-dialog",{attrs:{title:"编辑权限",visible:t.permData.show,center:"",width:"480px","close-on-click-modal":!1},on:{"update:visible":function(e){return t.$set(t.permData,"show",e)}}},[a("el-tabs",{model:{value:t.permData.active,callback:function(e){t.$set(t.permData,"active",e)},expression:"permData.active"}},[a("el-tab-pane",{attrs:{label:"专属权限",name:"one"}},[a("el-tree",{ref:"perm",attrs:{data:t.permData.form,"show-checkbox":"","default-checked-keys":t.permData.default,"node-key":"id"}})],1),a("el-tab-pane",{attrs:{label:"角色权限",name:"two"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择角色权限",clearable:"",filterable:""},model:{value:t.permData.role,callback:function(e){t.$set(t.permData,"role",e)},expression:"permData.role"}},t._l(t.userRole,(function(e){return a("el-option",{key:e.id,attrs:{label:e.role,value:e.id}},[a("span",{staticClass:"select_left"},[t._v(t._s(e.role))]),a("span",{staticClass:"select_right"},[t._v(t._s(e.id))])])})),1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.subPerm()}}},[t._v("更新")])],1)],1)],1)},o=[],r=(a("28a5"),a("7c2f")),i=a("58fd"),n={components:{Action:i["a"]},data:function(){return{LabelWidth:"80px",selectData:[],pageData:{list:[],total:0,page:1,limit:15},seaData:{show:!1,form:{uname:""}},addData:{show:!1,form:{tel:"",passwd:""}},editData:{show:!1,form:{tel:"",passwd:""}},delData:{show:!1,id:""},permData:{show:!1,active:"one",uid:"",default:[""],form:[],role:""},aMenus:[],userRole:[]}},mounted:function(){this.loadData(),this.allAction()},methods:{page:function(t){this.pageData.page=t,this.loadData()},getSelect:function(t){this.selectData=t},getEdit:function(t){if(this.selectData.length>0)for(var e in this.editData.show=!0,t)this.editData.form[e]=this.selectData[0][e]||"";else r["a"].toast("请选择数据!")},openAction:function(t){if("list"==t)this.seaData.form={role:""},this.pageData.page=1,this.loadData();else if("sea"==t)this.seaData.show=!0;else if("add"==t)this.addData.show=!0;else if("edit"==t)this.getEdit({uid:"",tel:"",passwd:""});else if("del"==t)if(this.selectData.length>0){this.delData.show=!0;for(var e=this.selectData,a="",s=0;s<e.length;s++)a+=e[s].uid+",";this.delData.id=a}else r["a"].toast("请选择数据!")},loadData:function(){var t=this,e=r["a"].loading();r["a"].post("Sysperm/list",{token:r["a"].storage.getItem("token"),page:this.pageData.page,limit:this.pageData.limit,data:JSON.stringify(this.seaData.form)},(function(a){e.clear();var s=a.data;0!=s.code?r["a"].toast(s.msg,"error"):(t.pageData.list=s.list,t.pageData.total=s.total)})),this.setClass()},subSea:function(){this.seaData.show=!1,this.pageData.page=1,this.loadData()},subAdd:function(){var t=this;this.addData.show=!1;var e=JSON.stringify(this.addData.form),a=r["a"].loading();r["a"].post("Sysperm/add",{token:r["a"].storage.getItem("token"),data:e},(function(e){var s=e.data;0!==s.code?(a.clear(),r["a"].toast(s.msg,"error")):(r["a"].toast(s.msg,"success"),t.loadData())}))},subEdit:function(){var t=this;this.editData.show=!1;var e=this.editData.form.uid,a=JSON.stringify(this.editData.form),s=r["a"].loading();r["a"].post("Sysperm/edit",{token:r["a"].storage.getItem("token"),uid:e,data:a},(function(e){var a=e.data;0!==a.code?(s.clear(),r["a"].toast(a.msg,"error")):(r["a"].toast(a.msg,"success"),t.loadData())}))},subDel:function(){var t=this;this.delData.show=!1;var e=r["a"].loading();r["a"].post("Sysperm/del",{token:r["a"].storage.getItem("token"),data:this.delData.id},(function(a){var s=a.data;0!==s.code?(e.clear(),r["a"].toast(s.msg,"error")):(r["a"].toast(s.msg,"success"),t.loadData())}))},setState:function(t,e){var a=e["state_"+t]?1:0,s=r["a"].loading();r["a"].post("Sysperm/state/"+t,{token:r["a"].storage.getItem("token"),uid:e.uid,state:a},(function(t){s.clear();var e=t.data;0!==e.code?r["a"].toast(e.msg,"error"):r["a"].toast(e.msg,"success")}))},setClass:function(){var t=this;this.getClass("userRole",(function(e){t.userRole=e.data.list}))},getClass:function(t,e){r["a"].post("Sysperm/getClass/"+t,{token:r["a"].storage.getItem("token")},e)},allAction:function(){var t=this;r["a"].post("Usermain/getActionAll",{token:r["a"].storage.getItem("token")},(function(e){var a=e.data;0!==a.code?r["a"].toast(a.msg,"error"):t.aMenus=a.aMenus}))},eidtPerm:function(t,e,a){var s=this;this.permData.uid=t,this.permData.role=a||"";var o=r["a"].loading();r["a"].post("Sysperm/allMenus",{token:r["a"].storage.getItem("token")},(function(t){o.clear();var a=t.data;if(0!==a.code)s.$message.error(a.msg);else{s.permData.show=!0,s.permData.form=a.menus;var r=[],i=[];if(e)for(var n=e.split(" "),l=[],c=0;c<n.length;c++)for(var u in l=n[c].split(":"),e=parseInt(l[1]),s.aMenus)e&parseInt(s.aMenus[u].perm)&&r.push(l[0]+":"+s.aMenus[u].perm);for(var d in r)i.push(a.id[r[d]]);setTimeout((function(){s.$refs.perm.setCheckedKeys(i)}),300)}}))},subPerm:function(){var t=this,e=this.$refs.perm.getCheckedKeys(),a=[],s=[],o=[],i={},n="";for(var l in e){for(var c in a=e[l].split(","),s=a[0].split("-"),s)i[s[c]]=0;o=a[1].split(":"),i[o[0]]=i[o[0]]?i[o[0]]+parseInt(o[1]):parseInt(o[1])}for(var u in i)n+=u+":"+i[u]+" ";this.permData.show=!1;var d=r["a"].loading();r["a"].post("Sysperm/perm",{token:r["a"].storage.getItem("token"),uid:this.permData.uid,perm:n,role:this.permData.role},(function(e){var a=e.data;0!==a.code?(d.clear(),t.$message.error(a.msg)):(t.$message.success(a.msg),t.loadData())}))}}},l=n,c=a("2877"),u=Object(c["a"])(l,s,o,!1,null,"79cf48ec",null);e["default"]=u.exports},"28a5":function(t,e,a){"use strict";var s=a("aae3"),o=a("cb7c"),r=a("ebd6"),i=a("0390"),n=a("9def"),l=a("5f1b"),c=a("520a"),u=a("79e5"),d=Math.min,p=[].push,m="split",f="length",h="lastIndex",g=4294967295,v=!u((function(){RegExp(g,"y")}));a("214f")("split",2,(function(t,e,a,u){var w;return w="c"=="abbc"[m](/(b)*/)[1]||4!="test"[m](/(?:)/,-1)[f]||2!="ab"[m](/(?:ab)*/)[f]||4!="."[m](/(.?)(.?)/)[f]||"."[m](/()()/)[f]>1||""[m](/.?/)[f]?function(t,e){var o=String(this);if(void 0===t&&0===e)return[];if(!s(t))return a.call(o,t,e);var r,i,n,l=[],u=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),d=0,m=void 0===e?g:e>>>0,v=new RegExp(t.source,u+"g");while(r=c.call(v,o)){if(i=v[h],i>d&&(l.push(o.slice(d,r.index)),r[f]>1&&r.index<o[f]&&p.apply(l,r.slice(1)),n=r[0][f],d=i,l[f]>=m))break;v[h]===r.index&&v[h]++}return d===o[f]?!n&&v.test("")||l.push(""):l.push(o.slice(d)),l[f]>m?l.slice(0,m):l}:"0"[m](void 0,0)[f]?function(t,e){return void 0===t&&0===e?[]:a.call(this,t,e)}:a,[function(a,s){var o=t(this),r=void 0==a?void 0:a[e];return void 0!==r?r.call(a,o,s):w.call(String(o),a,s)},function(t,e){var s=u(w,t,this,e,w!==a);if(s.done)return s.value;var c=o(t),p=String(this),m=r(c,RegExp),f=c.unicode,h=(c.ignoreCase?"i":"")+(c.multiline?"m":"")+(c.unicode?"u":"")+(v?"y":"g"),D=new m(v?c:"^(?:"+c.source+")",h),b=void 0===e?g:e>>>0;if(0===b)return[];if(0===p.length)return null===l(D,p)?[p]:[];var k=0,_=0,y=[];while(_<p.length){D.lastIndex=v?_:0;var x,S=l(D,v?p:p.slice(_));if(null===S||(x=d(n(D.lastIndex+(v?0:_)),p.length))===k)_=i(p,_,f);else{if(y.push(p.slice(k,_)),y.length===b)return y;for(var $=1;$<=S.length-1;$++)if(y.push(S[$]),y.length===b)return y;_=k=x}}return y.push(p.slice(k)),y}]}))},"58fd":function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.actions.length?a("el-row",{staticClass:"action"},[a("el-button-group",t._l(t.actions,(function(e){return a("el-button",{key:e.name,attrs:{icon:e.ico},on:{click:function(a){return t.openAction(e.action)}}},[t._v(t._s(e.name))])})),1)],1):t._e()},o=[],r=a("7c2f"),i={name:"ImageView",props:{url:{type:String,default:""}},data:function(){return{actions:[]}},mounted:function(){if(!this.url)return r["a"].toast("验证菜单不能为空!");this.getAction(this.url)},methods:{getAction:function(t){var e=this;r["a"].post("Usermain/getMenusAction",{token:r["a"].storage.getItem("token"),url:t},(function(t){var a=t.data;0==a.code&&(e.actions=a.menuAction)}))},openAction:function(t){this.$emit("action",t)}}},n=i,l=a("2877"),c=Object(l["a"])(n,s,o,!1,null,null,null);e["a"]=c.exports},aae3:function(t,e,a){var s=a("d3f4"),o=a("2d95"),r=a("2b4c")("match");t.exports=function(t){var e;return s(t)&&(void 0!==(e=t[r])?!!e:"RegExp"==o(t))}}}]);