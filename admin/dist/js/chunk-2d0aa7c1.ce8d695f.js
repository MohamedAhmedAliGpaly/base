(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0aa7c1"],{"10e1":function(t,a,e){"use strict";e.r(a);var o=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",[e("el-input",{staticClass:"hide",model:{value:t.actionType,callback:function(a){t.actionType=a},expression:"actionType"}}),e("el-row",{staticClass:"body"},[e("el-table",{attrs:{data:t.pageData.list,stripe:""},on:{"selection-change":t.getSelect}},[e("el-table-column",{attrs:{type:"selection",width:"45"}}),e("el-table-column",{attrs:{prop:"id",label:"ID",width:"50"}}),e("el-table-column",{attrs:{prop:"role",label:"名称",width:"180"}}),e("el-table-column",{attrs:{label:"更新时间",width:"180"},scopedSlots:t._u([{key:"default",fn:function(a){return[t._v("\n         "+t._s(a.row.utime||"空")+" \n        ")]}}])}),e("el-table-column",{attrs:{label:"操作","min-width":"180"},scopedSlots:t._u([{key:"default",fn:function(a){return[a.row.perm?e("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.eidtPerm(a.row.id,a.row.perm)}}},[t._v("修改权限")]):e("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(e){return t.eidtPerm(a.row.id,a.row.perm)}}},[t._v("设置权限")])]}}])})],1)],1),e("el-row",{staticClass:"page"},[e("el-pagination",{attrs:{background:"",layout:"prev, pager, next, total",total:t.pageData.total,"current-page":t.pageData.page,"page-size":t.pageData.limit},on:{"current-change":t.page}})],1),e("el-dialog",{attrs:{title:"搜索",visible:t.seaData.show,center:"",width:"420px"},on:{"update:visible":function(a){return t.$set(t.seaData,"show",a)}}},[e("el-form",{attrs:{model:t.seaData.form,"label-width":t.LabelWidth}},[e("el-form-item",{attrs:{label:"名称"}},[e("el-input",{attrs:{placeholder:"角色名称"},model:{value:t.seaData.form.role,callback:function(a){t.$set(t.seaData.form,"role",a)},expression:"seaData.form.role"}})],1)],1),e("div",{attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{type:"primary"},on:{click:function(a){return t.subSea()}}},[t._v("搜 索")])],1)],1),e("el-dialog",{attrs:{title:"添加",visible:t.addData.show,center:"",width:"420px","close-on-click-modal":!1},on:{"update:visible":function(a){return t.$set(t.addData,"show",a)}}},[e("el-form",{attrs:{model:t.addData.form,"label-width":t.LabelWidth}},[e("el-form-item",{attrs:{label:"名称"}},[e("el-input",{attrs:{placeholder:"角色名称"},model:{value:t.addData.form.role,callback:function(a){t.$set(t.addData.form,"role",a)},expression:"addData.form.role"}})],1)],1),e("div",{attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{type:"primary"},on:{click:function(a){return t.subAdd()}}},[t._v("添 加")])],1)],1),e("el-dialog",{attrs:{title:"编辑",visible:t.editData.show,center:"",width:"420px","close-on-click-modal":!1},on:{"update:visible":function(a){return t.$set(t.editData,"show",a)}}},[e("el-form",{attrs:{model:t.editData.form,"label-width":t.LabelWidth}},[e("el-form-item",{attrs:{label:"名称"}},[e("el-input",{attrs:{placeholder:"角色名称"},model:{value:t.editData.form.role,callback:function(a){t.$set(t.editData.form,"role",a)},expression:"editData.form.role"}})],1)],1),e("div",{attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{type:"primary"},on:{click:function(a){return t.subEdit()}}},[t._v("保 存")])],1)],1),e("el-dialog",{attrs:{title:"删除",visible:t.delData.show,center:"",width:"320px"},on:{"update:visible":function(a){return t.$set(t.delData,"show",a)}}},[e("div",[t._v("是否删除已选择数据？")]),e("div",{attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{type:"primary"},on:{click:function(a){return t.subDel()}}},[t._v("彻底删除")])],1)]),e("el-dialog",{attrs:{title:"编辑权限",visible:t.permData.show,center:"",width:"480px","close-on-click-modal":!1},on:{"update:visible":function(a){return t.$set(t.permData,"show",a)}}},[e("el-tree",{ref:"perm",attrs:{data:t.permData.form,"show-checkbox":"","default-checked-keys":t.permData.default,"node-key":"id"}}),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{type:"primary"},on:{click:function(a){return t.subPerm()}}},[t._v("更新")])],1)],1)],1)},i=[],s=(e("28a5"),e("7c2f")),r=e("58fd"),l={components:{Action:r["a"]},data:function(){return{LabelWidth:"80px",selectData:[],pageData:{list:[],total:0,page:1,limit:15},seaData:{show:!1,form:{role:""}},addData:{show:!1,form:{role:""}},editData:{show:!1,form:{role:""}},delData:{show:!1,id:""},permData:{show:!1,id:"",default:[""],form:[]},aMenus:[]}},computed:{actionType:function(){var t=this.$store.state.action.type;if("list"==t)this.seaData.form={role:""},this.pageData.page=1,this.loadData();else if("sea"==t)this.seaData.show=!0;else if("add"==t)this.addData.show=!0;else if("edit"==t){if(!(this.selectData.length>0))return s["a"].toast("请选择数据!");this.getEdit({id:"",role:""})}else if("del"==t){if(!(this.selectData.length>0))return s["a"].toast("请选择数据!");this.delData.show=!0;for(var a=this.selectData,e="",o=0;o<a.length;o++)e+=a[o].id+",";this.delData.id=e}return t}},mounted:function(){this.$store.state.action.url="SysRole",this.$store.state.action.menus="",this.loadData(),this.allAction()},methods:{page:function(t){this.pageData.page=t,this.loadData()},getSelect:function(t){this.selectData=t},loadData:function(){var t=this,a=s["a"].loading();s["a"].post("Sysrole/list",{token:s["a"].storage.getItem("token"),page:this.pageData.page,limit:this.pageData.limit,data:JSON.stringify(this.seaData.form)},(function(e){a.clear();var o=e.data;if(0!=o.code)return s["a"].toast(o.msg);t.pageData.list=o.list,t.pageData.total=o.total}))},subSea:function(){this.seaData.show=!1,this.pageData.page=1,this.loadData()},subAdd:function(){var t=this;this.addData.show=!1;var a=s["a"].loading();s["a"].post("Sysrole/add",{token:s["a"].storage.getItem("token"),data:JSON.stringify(this.addData.form)},(function(e){var o=e.data;return 0!==o.code?a.clear():t.loadData(),s["a"].toast(o.msg)}))},getEdit:function(t){for(var a in this.editData.show=!0,t)this.editData.form[a]=this.selectData[0][a]||""},subEdit:function(){var t=this;this.editData.show=!1;var a=s["a"].loading();s["a"].post("Sysrole/edit",{token:s["a"].storage.getItem("token"),id:this.editData.form.id,data:JSON.stringify(this.editData.form)},(function(e){var o=e.data;return 0!==o.code?a.clear():t.loadData(),s["a"].toast(o.msg)}))},subDel:function(){var t=this;this.delData.show=!1;var a=s["a"].loading();s["a"].post("Sysrole/del",{token:s["a"].storage.getItem("token"),data:this.delData.id},(function(e){var o=e.data;return 0!==o.code?a.clear():t.loadData(),s["a"].toast(o.msg)}))},allAction:function(){var t=this;s["a"].post("Usermain/getActionAll",{token:s["a"].storage.getItem("token")},(function(a){var e=a.data;if(0!==e.code)return s["a"].toast(e.msg);t.aMenus=e.aMenus}))},eidtPerm:function(t,a){var e=this;this.permData.id=t;var o=s["a"].loading();s["a"].post("Sysrole/allMenus",{token:s["a"].storage.getItem("token")},(function(t){var i=t.data;if(o.clear(),0!==i.code)return s["a"].toast(i.msg);if(e.permData.show=!0,e.permData.form=i.menus,a){for(var r=[],l=[],n=a.split(" "),d=[],c=0;c<n.length;c++)for(var u in d=n[c].split(":"),a=parseInt(d[1]),e.aMenus)a&parseInt(e.aMenus[u].perm)&&r.push(d[0]+":"+e.aMenus[u].perm);for(var p in r)l.push(i.id[r[p]]);setTimeout((function(){e.$refs.perm.setCheckedKeys(l)}),300)}}))},subPerm:function(){var t=this,a=this.$refs.perm.getCheckedKeys(),e=[],o=[],i=[],r={},l="";for(var n in a){for(var d in e=a[n].split(","),o=e[0].split("-"),o)r[o[d]]=0;i=e[1].split(":"),r[i[0]]=r[i[0]]?r[i[0]]+parseInt(i[1]):parseInt(i[1])}for(var c in r)l+=c+":"+r[c]+" ";this.permData.show=!1;var u=s["a"].loading();s["a"].post("Sysrole/perm",{token:s["a"].storage.getItem("token"),id:this.permData.id,perm:l},(function(a){var e=a.data;return 0!==e.code?u.clear():t.loadData(),s["a"].toast(e.msg)}))}}},n=l,d=e("2877"),c=Object(d["a"])(n,o,i,!1,null,"7d7caa15",null);a["default"]=c.exports}}]);