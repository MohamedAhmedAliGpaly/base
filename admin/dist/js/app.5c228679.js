(function(t){function e(e){for(var a,n,r=e[0],l=e[1],c=e[2],u=0,d=[];u<r.length;u++)n=r[u],Object.prototype.hasOwnProperty.call(i,n)&&i[n]&&d.push(i[n][0]),i[n]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(t[a]=l[a]);g&&g(e);while(d.length)d.shift()();return o.push.apply(o,c||[]),s()}function s(){for(var t,e=0;e<o.length;e++){for(var s=o[e],a=!0,n=1;n<s.length;n++){var r=s[n];0!==i[r]&&(a=!1)}a&&(o.splice(e--,1),t=l(l.s=s[0]))}return t}var a={},n={app:0},i={app:0},o=[];function r(t){return l.p+"js/"+({}[t]||t)+"."+{"chunk-223f7fea":"51a00a8a","chunk-2d0c8672":"044bbd57","chunk-34ced21d":"46bae79a","chunk-46db120e":"22047754","chunk-484aea7f":"69fc93c9","chunk-59d5547a":"89c7a058","chunk-5a3815ba":"78189b79","chunk-cec4b4a6":"2ddbc464","chunk-ceeee922":"2a75e7e3"}[t]+".js"}function l(e){if(a[e])return a[e].exports;var s=a[e]={i:e,l:!1,exports:{}};return t[e].call(s.exports,s,s.exports,l),s.l=!0,s.exports}l.e=function(t){var e=[],s={"chunk-223f7fea":1,"chunk-46db120e":1,"chunk-484aea7f":1,"chunk-59d5547a":1,"chunk-5a3815ba":1};n[t]?e.push(n[t]):0!==n[t]&&s[t]&&e.push(n[t]=new Promise((function(e,s){for(var a="css/"+({}[t]||t)+"."+{"chunk-223f7fea":"56785f2d","chunk-2d0c8672":"31d6cfe0","chunk-34ced21d":"31d6cfe0","chunk-46db120e":"e62e3814","chunk-484aea7f":"6f7acfda","chunk-59d5547a":"7fa743f1","chunk-5a3815ba":"8995dd9c","chunk-cec4b4a6":"31d6cfe0","chunk-ceeee922":"31d6cfe0"}[t]+".css",i=l.p+a,o=document.getElementsByTagName("link"),r=0;r<o.length;r++){var c=o[r],u=c.getAttribute("data-href")||c.getAttribute("href");if("stylesheet"===c.rel&&(u===a||u===i))return e()}var d=document.getElementsByTagName("style");for(r=0;r<d.length;r++){c=d[r],u=c.getAttribute("data-href");if(u===a||u===i)return e()}var g=document.createElement("link");g.rel="stylesheet",g.type="text/css",g.onload=e,g.onerror=function(e){var a=e&&e.target&&e.target.src||i,o=new Error("Loading CSS chunk "+t+" failed.\n("+a+")");o.code="CSS_CHUNK_LOAD_FAILED",o.request=a,delete n[t],g.parentNode.removeChild(g),s(o)},g.href=i;var p=document.getElementsByTagName("head")[0];p.appendChild(g)})).then((function(){n[t]=0})));var a=i[t];if(0!==a)if(a)e.push(a[2]);else{var o=new Promise((function(e,s){a=i[t]=[e,s]}));e.push(a[2]=o);var c,u=document.createElement("script");u.charset="utf-8",u.timeout=120,l.nc&&u.setAttribute("nonce",l.nc),u.src=r(t);var d=new Error;c=function(e){u.onerror=u.onload=null,clearTimeout(g);var s=i[t];if(0!==s){if(s){var a=e&&("load"===e.type?"missing":e.type),n=e&&e.target&&e.target.src;d.message="Loading chunk "+t+" failed.\n("+a+": "+n+")",d.name="ChunkLoadError",d.type=a,d.request=n,s[1](d)}i[t]=void 0}};var g=setTimeout((function(){c({type:"timeout",target:u})}),12e4);u.onerror=u.onload=c,document.head.appendChild(u)}return Promise.all(e)},l.m=t,l.c=a,l.d=function(t,e,s){l.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},l.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},l.t=function(t,e){if(1&e&&(t=l(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(l.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)l.d(s,a,function(e){return t[e]}.bind(null,a));return s},l.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return l.d(e,"a",e),e},l.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},l.p="",l.oe=function(t){throw console.error(t),t};var c=window["webpackJsonp"]=window["webpackJsonp"]||[],u=c.push.bind(c);c.push=e,c=c.slice();for(var d=0;d<c.length;d++)e(c[d]);var g=u;o.push([0,"chunk-vendors"]),s()})({0:function(t,e,s){t.exports=s("56d7")},"034f":function(t,e,s){"use strict";var a=s("64a9"),n=s.n(a);n.a},"56d7":function(t,e,s){"use strict";s.r(e);s("cadf"),s("551c"),s("f751"),s("097d");var a=s("2b0e"),n=s("8c4f");a["default"].use(n["a"]);var i=[{path:"/",name:"index",component:function(){return s.e("chunk-5a3815ba").then(s.bind(null,"d504"))}},{path:"/UserInfo",name:"UserInfo",component:function(t){return s.e("chunk-59d5547a").then(function(){var e=[s("8f77")];t.apply(null,e)}.bind(this)).catch(s.oe)}},{path:"/UserPasswd",name:"UserPasswd",component:function(t){return s.e("chunk-2d0c8672").then(function(){var e=[s("5573")];t.apply(null,e)}.bind(this)).catch(s.oe)}},{path:"/SysConfig",name:"SysConfig",component:function(t){return s.e("chunk-484aea7f").then(function(){var e=[s("5f2a")];t.apply(null,e)}.bind(this)).catch(s.oe)}},{path:"/SysMenus",name:"SysMenus",component:function(t){return s.e("chunk-46db120e").then(function(){var e=[s("a6e8")];t.apply(null,e)}.bind(this)).catch(s.oe)}},{path:"/SysMenusAction",name:"SysMenusAction",component:function(t){return s.e("chunk-cec4b4a6").then(function(){var e=[s("ddf3")];t.apply(null,e)}.bind(this)).catch(s.oe)}},{path:"/SysRole",name:"SysRole",component:function(t){return s.e("chunk-34ced21d").then(function(){var e=[s("10e1")];t.apply(null,e)}.bind(this)).catch(s.oe)}},{path:"/SysFileManage",name:"SysFileManage",component:function(t){return s.e("chunk-223f7fea").then(function(){var e=[s("52e8")];t.apply(null,e)}.bind(this)).catch(s.oe)}},{path:"/Test",name:"Test",component:function(t){return s.e("chunk-ceeee922").then(function(){var e=[s("78c1")];t.apply(null,e)}.bind(this)).catch(s.oe)}}],o=n["a"].prototype.push;n["a"].prototype.push=function(t){return o.call(this,t).catch((function(t){return t}))};var r=new n["a"]({base:"",routes:i}),l=r,c=s("2f62");a["default"].use(c["a"]);var u=new c["a"].Store({state:{statusBar:{height:"0px"},system:{},uinfo:{},socket:null,msgNum:0}}),d=s("8c89");function g(t){document.title=d["a"].title,t.prototype.$config=d["a"],t.prototype.$obj={scan:null,setTime:null,socket:null},t.prototype.$reg=function(t,e){var s=!1,a="",n={uname:/^[a-zA-Z][a-zA-Z0-9\_\@\-\*\&]{4,15}$/,tel:/^[1]\d{10}$/,email:/^([a-zA-Z0-9_-])+@([a-zA-Z0-9_-])+(\.[a-zA-Z0-9_-])+/,vcode:/^\d{4}$/,passwd:/^[a-zA-Z0-9|_|@|-|*|&]{6,16}$/};switch(t){case"uname":s=n.uname.test(e),a=s?"":"用户名英文开头5~16位！";break;case"tel":s=n.tel.test(e),a=s?"":"手机号码错误！";break;case"email":s=n.email.test(e),a=s?"":"邮箱帐号错误！";break;case"vcode":s=n.vcode.test(e),a=s?"":"验证码4位！";break;case"passwd":s=n.passwd.test(e),a=s?"":"密码为6~16位字符！";break}return!!s||a}}var p=s("bc3a"),m=s.n(p),f=s("d055"),h=s.n(f),v=s("5c96"),y=s.n(v),b=(s("8aa1"),function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"app"}},[t.update.show?s("div",{staticClass:"update_body",style:{backgroundColor:t.upDateColor.bg||t.$config.themeColor}},[s("div",{staticClass:"update_ct"},[s("div",{staticClass:"logo",style:{backgroundColor:t.upDateColor.logoBg}},[s("div")]),s("div",{staticClass:"loading",style:{backgroundImage:"linear-gradient(to right, "+t.upDateColor.loading+", "+t.upDateColor.loading+" "+t.update.loading+", "+t.upDateColor.loaded+" "+t.update.loading+", "+t.upDateColor.loaded+" 100%)"}}),s("div",{staticClass:"load_msg",domProps:{innerHTML:t._s(t.update.msg)}},[t._v("正在加载应用")]),s("div",{staticClass:"load_button"},[t.update.down?s("el-button",{style:{color:t.$config.themeColor},attrs:{round:"",size:"small"},on:{click:function(e){return t.updateDown()}}},[t._v("立即更新")]):t._e()],1)]),s("div",{staticClass:"update_logo",style:{color:t.upDateColor.copy}},[s("h1",[t._v(t._s(t.$config.title))]),s("h2",[t._v(t._s(t.$config.copy))])])]):t._e(),t.$store.state.system.login_bg?s("el-container",{directives:[{name:"show",rawName:"v-show",value:!t.isLogin,expression:"!isLogin"}],staticClass:"login_body bgimg bgcover",style:{backgroundImage:"url("+t.$config.baseUrl+t.$store.state.system.login_bg+")"}},[s("div",{staticClass:"login_ct"},[s("div",{staticClass:"logo flex_center"},[t.$store.state.system.logo?s("div",{staticClass:"bgimg radius bgcover",style:{backgroundImage:"url("+t.$config.baseUrl+t.$store.state.system.logo+")"}}):s("div",{staticClass:"bgimg radius"}),s("h1",{staticClass:"nowrap"},[t._v(t._s(t.$store.state.system.title))])]),s("h2",[t._v("用户登录")]),s("div",{staticClass:"item"},[s("el-input",{attrs:{placeholder:"用户名/手机/邮箱"},model:{value:t.login.uname,callback:function(e){t.$set(t.login,"uname",e)},expression:"login.uname"}},[s("template",{slot:"prepend"},[s("label",{staticClass:"ico_input"},[s("i",{staticClass:"ico_mask ico_user"})])])],2)],1),s("div",{staticClass:"item"},[s("el-input",{attrs:{type:"password",placeholder:"请输入密码"},model:{value:t.login.passwd,callback:function(e){t.$set(t.login,"passwd",e)},expression:"login.passwd"}},[s("template",{slot:"prepend"},[s("label",{staticClass:"ico_input"},[s("i",{staticClass:"ico_mask ico_passwd"})])])],2)],1),s("div",{staticClass:"item"},[s("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary",disabled:t.login.dis},on:{click:function(e){return t.loginSub()}}},[t._v(t._s(t.login.subText))])],1),s("div",{staticClass:"copy nowrap"},[t._v("© "+t._s(t.$store.state.system.copy)+" license  版本："+t._s(t.$config.version))])])]):t._e(),s("el-container",{directives:[{name:"show",rawName:"v-show",value:t.isLogin,expression:"isLogin"}],staticClass:"app_body"},[s("el-aside",{staticClass:"app_menus",style:{width:t.isCollapse?"64px":"200px",paddingTop:t.$store.state.statusBar.height}},[s("div",{staticClass:"app_img",on:{click:function(e){return t.openUrl("ico_mask ico_userinfo","UserInfo","11","基本资料",!0)}}},[t.$store.state.uinfo.img?s("div",{staticClass:"bgimg bgcover",style:{backgroundImage:"url("+t.$store.state.uinfo.img+")"}}):s("div",{staticClass:"bgimg"}),s("p",{staticClass:"nowrap"},[t._v(t._s(t.$store.state.uinfo.nickname||"昵称")+"("+t._s(t.$store.state.uinfo.name||"姓名")+")")])]),s("el-menu",{attrs:{"default-active":t.defaultMenu,collapse:t.isCollapse,"unique-opened":""}},t._l(t.menus,(function(e,a){return s("el-submenu",{key:a,attrs:{index:""+e.id}},[s("template",{slot:"title"},[s("i",{class:e.ico}),s("span",[t._v(t._s(e.title))])]),t._l(e.menus,(function(e,a){return s("div",{key:a},[0==e.menus.length?s("el-menu-item",{attrs:{index:""+e.id},on:{click:function(s){return t.openUrl(e.ico,e.url,""+e.id,e.title)}}},[t._v(t._s(e.title))]):s("el-submenu",{attrs:{index:""+e.id}},[s("template",{slot:"title"},[s("span",[t._v(t._s(e.title))])]),t._l(e.menus,(function(e,a){return s("el-menu-item",{key:a,attrs:{index:""+e.id},on:{click:function(s){return t.openUrl(e.ico,e.url,""+e.id,e.title)}}},[t._v(t._s(e.title))])}))],2)],1)}))],2)})),1),s("div",{staticClass:"app_version nowrap"},[t._v("版本："+t._s(t.$config.version))])],1),s("el-container",{style:{paddingTop:t.$store.state.statusBar.height}},[s("el-header",{staticClass:"app_top flex"},[s("el-tooltip",{staticClass:"logo",attrs:{effect:"dark",content:"点击”收缩/展开“左侧菜单",placement:"bottom-start"}},[s("a",{on:{click:function(e){return t.hideMenus()}}},[s("i",{staticClass:"el-icon-menu"}),t._v(" "+t._s(t.$storage.getItem("MenuName")||t.$store.state.system.title))])]),s("div",{staticClass:"uinfo"},[s("b",[t._v(t._s(t.$storage.getItem("uname")||"空"))]),t._v("  >\n          "),s("el-button",{attrs:{type:"text"},on:{click:function(e){return t.openConfig()}}},[t._v("设置")]),t._v("  |  \n          "),s("span",{staticClass:"logout",on:{click:function(e){return t.logout()}}},[t._v("退出")])],1)],1),s("el-main",{staticClass:"app_main"},[s("router-view"),s("div",{staticClass:"app_copy"},[t._v("所属："+t._s(t.$store.state.system.title)+"  © "+t._s(t.$store.state.system.copy)+"  版本："+t._s(t.$config.version))])],1)],1)],1),s("el-dialog",{attrs:{title:t.config.title,visible:t.config.show,center:"",width:"360px"},on:{"update:visible":function(e){return t.$set(t.config,"show",e)}}},[s("el-form",{attrs:{"label-width":"120px"}},[s("el-form-item",{attrs:{label:"消息朗读"}},[s("el-switch",{on:{change:function(e){return t.subConfig("is_msg_audio")}},model:{value:t.config.is_msg_audio,callback:function(e){t.$set(t.config,"is_msg_audio",e)},expression:"config.is_msg_audio"}})],1)],1)],1),s("ul",{directives:[{name:"show",rawName:"v-show",value:t.isLogin,expression:"isLogin"}],staticClass:"right_menus"},[s("li",{style:{backgroundColor:t.$config.themeColor},attrs:{title:"消息"},on:{click:function(e){return t.openMsg()}}},[t.$store.state.msgNum>0?s("el-badge",{attrs:{value:t.$store.state.msgNum}}):t._e(),s("i",{staticClass:"ico_mask ico_wechat"})],1)]),s("el-dialog",{staticClass:"msg_body",attrs:{visible:t.msgData.show,center:"",width:"640px"},on:{"update:visible":function(e){return t.$set(t.msgData,"show",e)}}},[s("div",{staticClass:"msg_title flex",attrs:{slot:"title"},slot:"title"},[s("div",[1!=t.msgData.gid&&""!=t.msgData.gid?s("el-popover",{attrs:{trigger:"hover",placement:"bottom-start"}},[s("ul",{staticClass:"msg_title_tool"},[s("li",{staticClass:"flex"},[s("span",[t._v("群设置")]),s("i",{staticClass:"el-icon-setting"})]),s("li",{staticClass:"flex"},[s("span",[t._v("退出该群")]),s("i",{staticClass:"el-icon-delete"})])]),s("div",{attrs:{slot:"reference"},slot:"reference"},[s("span",[t._v(t._s(t.msgData.title)),s("i",{staticClass:"el-icon-caret-bottom"})])])]):s("span",[t._v(t._s(t.msgData.title))])],1)]),s("div",{staticClass:"msg_sea"},[s("el-input",{staticClass:"sea",attrs:{placeholder:"搜索",size:"small"}},[s("el-button",{attrs:{slot:"append",icon:"el-icon-plus",size:"small",title:"创建组"},on:{click:function(e){return t.addGroup()}},slot:"append"})],1)],1),s("el-container",[s("el-aside",{staticClass:"msg_left",attrs:{width:"210px"}},[s("ul",{staticClass:"msg_group"},t._l(t.msgData.group,(function(e,a){return s("li",{key:a,staticClass:"flex",on:{click:function(s){return t.getMsg(a,e)}}},[s("div",1==a?{staticClass:"img",style:{backgroundImage:"url("+(t.$config.baseUrl+t.$store.state.system.logo)+")"}}:{staticClass:"img",style:{backgroundImage:"url("+(e.data.length>0?e.data[e.data.length-1].img:"")+")"}},[e.num>0?s("el-badge",{attrs:{value:e.num}}):t._e()],1),s("div",{staticClass:"ct"},[s("div",{staticClass:"title flex"},[s("h2",{staticClass:"nowrap"},[t._v(t._s(e.name))]),s("span",[t._v(t._s(e.data.length>0?e.data[e.data.length-1].ctime.substr(11,5):""))])]),e.data.length>0?s("div",{staticClass:"text nowrap"},[t._v("["+t._s(t.getMsgType(e.data[e.data.length-1].type))+"]"+t._s(e.data[e.data.length-1].content))]):s("div",{staticClass:"text nowrap"},[t._v("暂无消息")])])])})),0)]),s("div",{staticClass:"msg_right"},[s("div",{ref:"msgMain",staticClass:"msg_html"},[s("div",{ref:"msgContent",staticClass:"msg_ct"},[t.msgData.data.length>0?t._l(t.msgData.data,(function(e,a){return s("div",{key:a},[s("div",{staticClass:"msg_ct_time"},[t._v(t._s(e.ctime))]),e.fid!=t.$store.state.uinfo.uid?s("div",{staticClass:"flex_left"},[s("div",{staticClass:"head flex"},[s("i",{style:{backgroundImage:"url("+(1==e.gid?t.$config.baseUrl+t.$store.state.system.logo:e.img)+")"}}),s("div",{staticClass:"arrow_left"})]),s("div",{staticClass:"msgCt",domProps:{innerHTML:t._s(e.content)}})]):s("div",{staticClass:"flex_right"},[s("div",{staticClass:"msgCt mebg",domProps:{innerHTML:t._s(e.content)}}),s("div",{staticClass:"head flex"},[s("div",{staticClass:"arrow_right"}),s("i",{style:{backgroundImage:"url("+e.img+")"}})])])])})):s("div",{staticClass:"null"})],2)]),s("div",{staticClass:"msg_send"},[s("div",{staticClass:"msg_tool flex"},[s("ul",{staticClass:"msg_tool_ico flex"},[s("li",{staticClass:"ico_mask ico_patient",attrs:{title:"患者"}})]),s("el-button",{attrs:{size:"small"},on:{click:function(e){return t.sendMsg()}}},[t._v("发送")])],1),s("div",{staticClass:"msg_seng_ct"},[s("el-input",{ref:"msgSend",attrs:{type:"textarea",placeholder:"请输入内容"},model:{value:t.msgData.content,callback:function(e){t.$set(t.msgData,"content",e)},expression:"msgData.content"}})],1)])])],1)],1),s("el-dialog",{attrs:{visible:t.msgGroup.show,center:"",width:"420px"},on:{"update:visible":function(e){return t.$set(t.msgGroup,"show",e)}}},[s("el-form",{attrs:{model:t.msgGroup.add,"label-width":"80px"}},[s("el-form-item",{attrs:{label:"组名称"}},[s("el-input",{attrs:{maxlength:"16",placeholder:"聊天组名称"},model:{value:t.msgGroup.add.title,callback:function(e){t.$set(t.msgGroup.add,"title",e)},expression:"msgGroup.add.title"}})],1),s("el-form-item",{attrs:{label:"选择成员"}})],1),s("div",{attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.subGroup()}}},[t._v("创建")])],1)],1)],1)}),_=[],C=(s("7f7f"),s("20d6"),{unique:function(t){for(var e=[],s=0,a=t.length;s<a;s++){for(var n=s+1;n<a;n++)t[s]===t[n]&&(n=++s);e.push(t[s])}return e},getDay:function(t,e){var s=e?new Date(e):new Date;s.setDate(s.getDate()+t);var a=s.getFullYear(),n=s.getMonth()+1<10?"0"+(s.getMonth()+1):s.getMonth()+1,i=s.getDate()<10?"0"+s.getDate():s.getDate();return a+"-"+n+"-"+i},getWeek:function(t){var e=new Date(t),s=["日","一","二","三","四","五","六"];return s[e.getDay()]},getDate:function(){var t=new Date,e=t.getFullYear(),s=t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1,a=t.getDate()<10?"0"+t.getDate():t.getDate(),n=t.getHours()<10?"0"+t.getHours():t.getHours(),i=t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes(),o=t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds();return e+"-"+s+"-"+a+" "+n+":"+i+":"+o},tinymce:function(){return{language:"zh_CN",language_url:"/tinymce/zh_CN.js",skin_url:"/tinymce/skins/ui/oxide",height:550,menubar:!0,branding:!1,toolbar:"undo redo | bold italic backcolor | alignleft aligncenter alignright alignjustify | bullist numlist | table image media preview | removeformat | help",toolbar_items_size:"small",plugins:["advlist autolink lists link image charmap print preview anchor textcolor","searchreplace visualblocks code fullscreen","insertdatetime media table paste code help wordcount"]}}}),k=s("9060"),w=s("229e"),$=s("616b");w["a"].use($["a"]);var x={name:"APP",data:function(){return{isLogin:!1,isCollapse:!1,defaultMenu:"",update:{show:!1,os:"",down:!1,loading:"0%",msg:"检测更新",file:"",total:0},upDateColor:d["a"].upDateColor,login:{uname:"",passwd:"",subText:"登录",dis:!1},menus:[],config:{show:!1,title:"系统配置",is_msg_audio:!0},scan:{show:!1},scanData:{show:!1,active:"one",title:"今日患者医嘱( "+C.getDay(0)+" )",uid:"",pid:"",info:"",data:{}},scanTimeout:null,msgData:{show:!1,scroll:null,y:0,title:"消息系统",content:"",gid:"",data:[],group:[]},msgGroup:{show:!1,class:[],add:{uid:"",title:""}}}},mounted:function(){var t=this;setTimeout((function(){t.init()}),3e3),document.body.onclick=function(){var t=document.getElementById("msgAudio");if(!t){var e=document.createElement("audio");e.setAttribute("id","msgAudio"),document.body.appendChild(e)}},this.isCollapse="true"==this.$storage.getItem("isCollapse"),this.defaultMenu=this.$storage.getItem("defaultMenu")?this.$storage.getItem("defaultMenu"):"3",this.getConfig(),this.loginVerify()},methods:{init:function(){var t=this;try{plus,plus.navigator.setStatusBarStyle("dark"),plus.navigator.setStatusBarBackground(d["a"].themeColor),this.$store.state.statusBar.height=k["a"].getStatusBarHeight()+"px";var e=0,s=plus.webview.currentWebview();plus.key.addEventListener("backbutton",(function(){s.canBack((function(s){s.canBack?(t.$router.go(-1),t.$obj.scan&&t.$obj.scan.close()):(e>0&&plus.runtime.quit(),t.$createToast({txt:"再按一次退出应用!"}).show(),e++,setTimeout((function(){e=0}),2e3))}))}),!1),d["a"].update&&this.isUpdate()}catch(a){console.log("plus: 不兼容")}},getConfig:function(){var t=this;this.$ajax.post(this.$config.apiUrl+"index/getConfig").then((function(e){var s=e.data;0==s.code&&(t.$store.state.system=s.list)}))},loginVerify:function(){var t=this,e=this.$storage.getItem("token");if(!e)return!1;this.isLogin=!0,this.token((function(e){var s=e.data;if(0!=s.code)return t.logout();t.$store.state.uinfo=s.uinfo,t.$storage.setItem("uinfo",JSON.stringify(s.uinfo)),t.config.is_msg_audio="1"==s.uinfo.is_msg_audio,t.config.is_group="1"==s.uinfo.is_group,t.getMenus(),t.socketStart()}))},socketStart:function(){var t=this;this.$ajax.post(this.$config.apiUrl+"Usermain/centreToken","token="+this.$storage.getItem("token")).then((function(e){0==e.data.code&&t.socket(e.data.token,e.data.uid)}))},socket:function(t,e){var s=this;this.$store.state.socket=new WebSocket(d["a"].socketServer+"?token="+t+"&uid="+e),this.$store.state.socket.onopen=function(){console.log("消息系统"),clearInterval(s.heartbeat),s.heartbeat=setInterval((function(){try{s.$store.state.socket.send(JSON.stringify({type:""}))}catch(t){s.socketStart()}}),1e4),s.$store.state.socket.send(JSON.stringify({type:"group"}))},this.$store.state.socket.onclose=function(){console.log("消息关闭"),setTimeout((function(){s.socketStart()}),1e4)},this.$store.state.socket.onmessage=function(t){var e=JSON.parse(t.data);0==e.code&&"group"==e.type?(s.msgData.group=e.data,s.getMsgNum()):0==e.code&&"msg"==e.type&&(1==e.gid&&(e.data.img=s.$config.baseUrl+s.$store.state.system.logo,e.data.title&&k["a"].notify(e.data.title,e.data.content,(function(t){t.close()}),s.config.is_msg_audio)),s.msgData.group[""+e.gid].data.push(e.data),s.msgData.show&&e.gid==s.msgData.gid||(s.msgData.group[""+e.gid].num+=1),s.getMsgNum(),s.reMsgScroll())}},getMsgNum:function(){var t=this.msgData.group,e=0;for(var s in t)e+=t[s].num;this.$store.state.msgNum=e},getMenus:function(){var t=this;this.$ajax.post(this.$config.apiUrl+"Usermain/getMenus","token="+this.$storage.getItem("token")).then((function(e){var s=e.data;0==s.code&&(t.menus=s.menus)}))},openUrl:function(t,e,s,a,n){if(this.$storage.setItem("MenuName",a),this.$storage.setItem("defaultMenu",s),"3"!=s){var i=JSON.parse(this.$storage.getItem("Menus")||"[]"),o={ico:t,url:e,index:s,name:a},r=i.findIndex((function(t){return JSON.stringify(t)==JSON.stringify(o)}));r>=0&&i.splice(r,1),i.push({ico:t,url:e,index:s,name:a}),this.$storage.setItem("Menus",JSON.stringify(i))}this.$router.push(e),n&&setTimeout((function(){window.location.reload()}),300)},loginSub:function(){var t=this,e=this.login.uname,s=this.login.passwd;return!(!e||!s)&&(1!=this.$reg("uname",e)&&1!=this.$reg("tel",e)&&1!=this.$reg("email",e)?this.$message.error("请输入帐号/手机/邮箱！"):1!=this.$reg("passwd",s)?this.$message.error(this.$reg("passwd",s)):(this.login.subText="正在登录",this.login.dis=!0,void this.$ajax.post(this.$config.apiUrl+"user/login","uname="+e+"&passwd="+s).then((function(s){t.login.subText="登录",t.login.dis=!1;var a=s.data;0!=a.code?t.$message.error(a.msg):(t.isLogin=!0,t.$storage.setItem("token",a.token),t.$storage.setItem("uname",e),t.loginVerify())}))))},logout:function(){this.isLogin=!1,this.$storage.setItem("token",""),this.$storage.setItem("uinfo","")},token:function(t){this.$ajax.post(this.$config.apiUrl+"user/token","token="+this.$storage.getItem("token")).then(t)},hideMenus:function(){this.isCollapse=!this.isCollapse,this.$storage.setItem("isCollapse",this.isCollapse)},isUpdate:function(){var t=this;this.update.os=plus.os.name,this.$ajax.post(this.$config.apiUrl+"index/appUpdate","os="+this.update.os).then((function(e){var s=e.data;if(0!=s.code)return!1;plus.runtime.getProperty(plus.runtime.appid,(function(e){if(s.version==e.version)return!1;t.update.show=!0,t.update.down=!0,t.update.msg="新版本: "+s.version+"&nbsp;&nbsp;大小: "+(s.size/1024/1024).toFixed(2)+"MB",t.update.file=t.$config.baseUrl+s.file,t.update.total=s.size}))}))},updateDown:function(){var t=this;if(this.update.down=!1,this.update.msg="开始下载",this.update.loading="0%","iOS"==this.update.os)this.update.msg="请在桌面查看安装进度",window.open(d["a"].upIosUrl),setTimeout((function(){plus.runtime.quit()}),5e3);else{var e=plus.downloader.createDownload(this.update.file,{filename:"_doc/download/",timeout:30},(function(e,s){200==s?plus.runtime.install(e.filename,{force:!0},(function(){plus.runtime.restart()}),(function(e){t.$createToast({txt:"安装失败"}).show()})):(t.update.down=!0,t.update.msg="下载失败")}));e.start(),e.addEventListener("statechanged",(function(e,s){var a=parseInt(e.downloadedSize/t.update.total*100);t.update.loading=a+"%",t.update.msg="正在下载："+t.update.loading,a>=100&&(t.update.msg="下载完成，安装并重启")}))}},openConfig:function(){this.config.show=!0},subConfig:function(t){var e=this,s={};s[t]=this.config[t]?"1":"0";var a=this.$loading({text:"更改状态"});this.$ajax.post(this.$config.apiUrl+"Userinfo/edit","token="+this.$storage.getItem("token")+"&data="+JSON.stringify(s)).then((function(s){a.close();var n=s.data;return e.$store.state.uinfo[t]=e.config[t],0==n.code?e.$message.success(n.msg):e.$message.error(n.msg)}))},openMsg:function(){var t=this;this.msgData.show=!0,this.msgData.gid&&this.getChannel(),setTimeout((function(){t.$refs.msgSend;document.onkeydown=function(e){return e.ctrlKey&&13==e.keyCode?(t.msgData.content+="\n",!1):13==e.keyCode?(t.sendMsg(),!1):void 0}}),300)},getMsg:function(t,e){this.msgData.gid=t,this.msgData.title=e.name,this.msgData.data=e.data,this.msgData.group[t].num=0,this.getMsgNum(),this.getChannel()},sendMsg:function(){if(!this.msgData.gid)return this.$message.error("请选择组");if(!this.msgData.content)return this.$message.error("请输入消息");var t={gid:this.msgData.gid,fid:this.$store.state.uinfo.uid,content:this.msgData.content,img:this.$store.state.uinfo.img,ctime:C.getDate()};this.$store.state.socket.send(JSON.stringify({type:"msg",gid:this.msgData.gid,data:t})),1==this.msgData.gid&&this.msgData.group["1"].data.push(t),this.msgData.content=""},addGroup:function(){console.log(123),this.msgGroup.show=!0},subGroup:function(){console.log("提交组")},reMsgScroll:function(){var t=this;setTimeout((function(){t.msgData.scroll.refresh();var e=t.$refs.msgContent.scrollHeight,s=e-t.msgData.y;t.msgData.y=e,t.msgData.scroll.maxScrollY<0&&t.msgData.scroll.scrollBy(0,-s,0)}),300)},getChannel:function(){var t=this;setTimeout((function(){t.msgData.scroll||(t.msgData.scroll=new w["a"](t.$refs.msgMain,{click:!0,pullUpLoad:!0}),t.msgData.scroll.on("touchEnd",(function(t){t.y>30&&console.log("下拉")}))),t.msgData.scroll.refresh();var e=t.$refs.msgContent.scrollHeight;t.msgData.scroll.scrollBy(0,-e,0),t.msgData.y=e}),300)},getMsgType:function(t){var e=["消息","转诊"];return e[t]}}},S=x,D=(s("034f"),s("2877")),M=Object(D["a"])(S,b,_,!1,null,null,null),I=M.exports;a["default"].prototype.$ajax=m.a,a["default"].prototype.$storage=window.localStorage,a["default"].prototype.$qrcode=h.a,a["default"].use(g),a["default"].use(y.a),a["default"].config.productionTip=!1,new a["default"]({router:l,store:u,render:function(t){return t(I)}}).$mount("#app")},"5faa":function(t,e,s){"use strict";var a=s("b743"),n=s.n(a);n.a},"64a9":function(t,e,s){},"8aa1":function(t,e,s){},"8c89":function(t,e,s){"use strict";var a="https://api.webmis.vip/",n="基础系统",i="wss://webmis.vip/wss";e["a"]={title:n,version:"v1.0.0",baseUrl:a,apiUrl:a+"admin/",themeColor:"#6FB737",copy:"Copyright © WebMIS.vip 2020",statusBar:{height:"0px",color:"#333",bgColor:"#FFF"},update:!0,upDateColor:{bg:"",logoBg:"#FFF",loading:"#FFF",loaded:"#666",copy:"#333"},upIosUrl:"itms-apps://itunes.apple.com/cn/app/tao-bao-sui-shi-sui-xiang/id387682726?mt=8",amapKey:"d956f0c3e15489a1b5bf291e5d133c8a",baiduOcr:"https://aip.baidubce.com/rest/2.0/ocr/v1/",socketServer:i,msgRead:1e3,msgNew:3e5,msgContent:"title",msgBrowser:!1}},9060:function(t,e,s){"use strict";s("386d"),s("7f7f");var a=s("2b0e"),n=s("8c89"),i=s("8f9b"),o=s.n(i),r=s("bc3a"),l=s.n(r),c=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"notify_body",style:{backgroundColor:t.bgColor,color:t.color}},[s("div",{staticClass:"notify_title flex"},[s("div",{staticClass:"logo"}),s("h2",{staticClass:"nowrap"},[t._v(t._s(t.title))]),s("div",{staticClass:"close"})]),t.content?s("div",{staticClass:"notify_content",domProps:{innerHTML:t._s(t.content)}}):t._e()])},u=[],d={name:"Notify",props:{title:{type:String,default:"消息"},content:{type:String,default:""},bgColor:{type:String,default:"#FFF"},color:{type:String,default:"#333"}},data:function(){return{}},mounted:function(){},methods:{}},g=d,p=(s("5faa"),s("2877")),m=Object(p["a"])(g,c,u,!1,null,"840c12a2",null),f=m.exports,h={install:function(t){var e=function(t){t.style.transition="all .3s ease",t.style.transform="translate(0, 0)",t.style.opacity="1"},s=function(t,e){t.style.transition="all .3s ease",t.style.transform="translate(0, -100%)",t.style.opacity="0",setTimeout((function(){e.removeChild(t)}),300)};t.prototype.$msgNotify=function(a){var n=t.extend(f),i=new n,o=document.createElement("div");i.$mount(o),i.title=a.title||"标题",i.content=a.content||"",i.color=a.color||"#333",i.bgColor=a.bgColor||"rgba(255,255,255,.9)",a.delay=a.delay||5e3,a.onClick=a.onClick||function(){};var r=document.getElementById("notifyBody");r||(r=document.createElement("div"),r.setAttribute("id","notifyBody"),r.setAttribute("style","position: fixed; z-index: 9999; width: 100%; max-width: 360px; top: 10px; left: 0; right: 0; margin: auto;")),document.body.appendChild(r),r.appendChild(i.$el),setTimeout((function(){e(i.$el)}),300),i.$el.stime=setTimeout((function(){s(i.$el,r)}),a.delay),i.$el.onclick=function(){a.onClick(this)},i.$el.close=function(){clearTimeout(i.$el.stime),s(i.$el,r)}}}},v=h;a["default"].use(v),o.a.initAMapApiLoader({key:n["a"].amapKey,plugin:["AMap.Geolocation","PlaceSearch"],v:"1.4.15"});e["a"]={isPlus:function(t){document.addEventListener("plusready",t,!1)},getStatusBarHeight:function(){var t=0,e=/Html5Plus\/.+\s\(.*(Immersed\/(\d+\.?\d*).*)\)/gi.exec(navigator.userAgent);return e&&e.length>=3&&(t=parseFloat(e[2])),t},notify:function(t,e,s,i){n["a"].msgBrowser&&window.Notification&&"denied"!==Notification.permission&&Notification.requestPermission((function(s){setTimeout((function(){new Notification(t,{body:e})}),n["a"].msgRead)})),setTimeout((function(){a["default"].prototype.$msgNotify({title:t,content:e,delay:1e4,onClick:s})}),n["a"].msgRead),i=i||!1,console.log(i),i&&l.a.post(n["a"].apiUrl+"index/baiduToken").then((function(s){var a=new Audio,i="title"==n["a"].msgContent?t:e;a.src="https://tsn.baidu.com/text2audio?lan=zh&ctp=1&cuid=1&tex="+i+"&tok="+s.data.token,setTimeout((function(){try{if("iOS"==plus.os.name){var t=plus.ios.importClass("AVAudioSession"),e=t.sharedInstance();e.setCategoryerror("AVAudioSessionCategoryPlayback",null),e.setActiveerror("YES",null);var s=plus.ios.importClass("AVSpeechSynthesizer"),n=plus.ios.importClass("AVSpeechUtterance"),o=plus.ios.import("AVSpeechSynthesisVoice"),r=new s,l=o.voiceWithLanguage("zh-CN"),c=n.speechUtteranceWithString(i);c.setVoice(l),r.speakUtterance(c)}else a.play()}catch(u){a.play()}}),n["a"].msgRead)}))},pay:function(t,e,s,a,n){var i="";for(var o in s)i+=o+"="+s[o]+"&";try{"alipay"==t?i+="type=app":"wxpay"==t&&(i+="type=APP"),plus.payment.getChannels((function(s){var o=null;for(var r in s)s[r].id==t&&(o=s[r]);l.a.post(e,i).then((function(t){var e=t.data;0==e.code?plus.payment.request(o,e.data,a,n):console.log(e.msg)}))}),(function(t){console.log("支付通道: "+t.message)}))}catch(r){console.log("H5方式: "+t)}},geoLocation:function(t,e){try{plus.geolocation.getCurrentPosition((function(e){var s={};s.province=e.address.province,s.city=e.address.city,s.latitude=e.coords.latitude,s.longitude=e.coords.longitude,window.localStorage.setItem("GeoLocation",JSON.stringify(s)),t(s)}),e)}catch(s){setTimeout((function(){AMap.service(["AMap.Geolocation"],(function(){var s=new AMap.Geolocation({enableHighAccuracy:!1,timeout:5e3});s.getCityInfo((function(a,n){var i={};i.province=n.province,i.city=n.city,s.getCurrentPosition((function(s,a){a&&a.position?(i.latitude=a.position.lat,i.longitude=a.position.lng,window.localStorage.setItem("GeoLocation",JSON.stringify(i)),t(i)):e(s)}))}))}))}),500)}},getAddress:function(t,e,s){setTimeout((function(){AMap.service(["AMap.PlaceSearch"],(function(){var a=window.localStorage.getItem("GeoLocation");a=a?JSON.parse(a):{city:"昆明市"};var n=new AMap.PlaceSearch({city:a.city});n.search(t,(function(t,a){a&&a.poiList?e(a.poiList.pois):s(t)}))}))}),500)},camera:function(t,e){try{var s=plus.camera.getCamera();s.captureImage((function(e){plus.io.resolveLocalFileSystemURL(e,(function(e){e.file((function(e){t(e)}))}),(function(t){console.log("读取拍照失败")}))}),e)}catch(n){var a=document.createElement("input");a.setAttribute("type","file"),a.setAttribute("style","display: none"),document.body.appendChild(a),a.click(),a.onchange=function(){t(a.files[0])}}},photo:function(t,e,s){s=s||!0;try{plus.gallery.pick((function(e){var s=e.files,a=[],n=null;for(var i in s)plus.io.resolveLocalFileSystemURL(s[i],(function(e){e.file((function(e){a.push(e),clearTimeout(n),n=setTimeout((function(){t(a)}),300)}))}),(function(t){console.log("读取文件: "+t.message)}))}),e,{filter:"image",multiple:s})}catch(n){var a=document.createElement("input");a.setAttribute("type","file"),a.setAttribute("style","display: none"),s&&a.setAttribute("multiple","multiple"),document.body.appendChild(a),a.click(),a.onchange=function(){t(a.files)}}},readerCompress:function(t,e,s){var a=this;try{var n=new plus.io.FileReader;n.readAsDataURL(t),n.onloadend=function(){e.ext||("image/jpeg"==t.type?e.ext="jpg":"image/png"==t.type?e.ext="png":"image/gif"==t.type&&(e.ext="gif")),a.compressImage(this.result,e,s)}}catch(o){var i=new FileReader;i.readAsDataURL(t),i.onloadend=function(){e.ext||("image/jpeg"==t.type?e.ext="jpg":"image/png"==t.type?e.ext="png":"image/gif"==t.type&&(e.ext="gif")),a.compressImage(this.result,e,s)}}},compressImage:function(t,e,s){var a=e.width||0,n=e.height||0,i=e.cut||!0,o=e.quality||.8,r=e.ext||"jpg",l={jpg:"image/jpeg",png:"image/png",gif:"image/gif"},c=1,u=1,d=0,g=0,p=1,m=c/u,f=document.createElement("canvas"),h=f.getContext("2d"),v=new Image;v.src=t,v.onload=function(){m=this.width/this.height,a>0&&0==n?(c=a<this.width?a:this.width,u=a<this.width?Math.round(a/m):Math.round(this.width/m),a=c,n=u):0==a&&n>0?(c=n<this.height?Math.round(n*m):Math.round(this.height*m),u=n<this.height?n:this.height,a=c,n=u):0==a&&0==n?(c=this.width,u=this.height,a=c,n=u):(p=a/n,m>p?a<this.width?(c=i?Math.round(n*m):a,u=i?n:Math.round(a/m)):(c=i?Math.round(this.height*m):this.width,u=i?this.height:Math.round(this.width/m)):n<this.height?(c=i?a:Math.round(n*m),u=i?Math.round(a/m):n):(c=i?this.width:Math.round(this.height*m),u=i?Math.round(this.width/m):this.height)),f.width=a,f.height=n,d=Math.round(a-c)/2,g=Math.round(n-u)/2,h.drawImage(this,d,g,c,u);var t=f.toDataURL(l[r],o);s(t)}},video:function(t,e){try{var s=plus.camera.getCamera();s.startVideoCapture((function(e){plus.io.resolveLocalFileSystemURL(e,(function(s){t(e,s)}),(function(t){console.log("读取录像失败")}))}),e)}catch(a){console.log("录像")}},audio:function(t,e,s){try{t.record({filename:"_doc/audio/"},(function(t){plus.io.resolveLocalFileSystemURL(t,(function(s){e(t,s)}),(function(t){console.log("读取音频失败")}))}),s)}catch(a){console.log("录音")}},uploader:function(t,e,s,a){try{for(var n=plus.uploader.createUpload(t,{method:"POST"},s),i=0;i<e.length;i++)"file"==e[i].type?n.addFile(e[i].val,{key:e[i].key}):"data"==e[i].type&&n.addData(e[i].key,e[i].val);n.addEventListener("statechanged",a,!1),n.start()}catch(o){console.log("上传文件")}},cacheClear:function(){try{plus.io.resolveLocalFileSystemURL("_doc/",(function(t){return t.removeRecursively()}),(function(t){console.log("清理缓存失败")}))}catch(t){console.log("清理缓存")}}}},b743:function(t,e,s){}});
//# sourceMappingURL=app.5c228679.js.map