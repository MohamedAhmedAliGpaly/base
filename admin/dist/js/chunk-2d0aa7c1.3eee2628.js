(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0aa7c1"],{"10e1":function(t,e,a){"use strict";a.r(e);var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-input",{staticClass:"hide",model:{value:t.actionType,callback:function(e){t.actionType=e},expression:"actionType"}}),a("el-row",{staticClass:"body"},[a("el-table",{attrs:{data:t.pageData.list,stripe:""},on:{"selection-change":t.getSelect}},[a("el-table-column",{attrs:{type:"selection",width:"45"}}),a("el-table-column",{attrs:{prop:"id",label:"ID",width:"50"}}),a("el-table-column",{attrs:{prop:"role",label:"名称",width:"180"}}),a("el-table-column",{attrs:{label:"更新时间",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n         "+t._s(e.row.utime||"空")+" \n        ")]}}])}),a("el-table-column",{attrs:{label:"操作","min-width":"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.perm?a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){return t.eidtPerm(e.row.id,e.row.perm)}}},[t._v("修改权限")]):a("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(a){return t.eidtPerm(e.row.id,e.row.perm)}}},[t._v("设置权限")])]}}])})],1)],1),a("el-row",{staticClass:"page"},[a("el-pagination",{attrs:{background:"",layout:"prev, pager, next, total",total:t.pageData.total,"current-page":t.pageData.page,"page-size":t.pageData.limit},on:{"current-change":t.page}})],1),a("el-dialog",{attrs:{title:"搜索",visible:t.seaData.show,center:"",width:"420px"},on:{"update:visible":function(e){return t.$set(t.seaData,"show",e)}}},[a("el-form",{attrs:{model:t.seaData.form,"label-width":t.LabelWidth}},[a("el-form-item",{attrs:{label:"名称"}},[a("el-input",{attrs:{placeholder:"角色名称"},model:{value:t.seaData.form.role,callback:function(e){t.$set(t.seaData.form,"role",e)},expression:"seaData.form.role"}})],1)],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.subSea()}}},[t._v("搜 索")])],1)],1),a("el-dialog",{attrs:{title:"添加",visible:t.addData.show,center:"",width:"420px","close-on-click-modal":!1},on:{"update:visible":function(e){return t.$set(t.addData,"show",e)}}},[a("el-form",{attrs:{model:t.addData.form,"label-width":t.LabelWidth}},[a("el-form-item",{attrs:{label:"名称"}},[a("el-input",{attrs:{placeholder:"角色名称"},model:{value:t.addData.form.role,callback:function(e){t.$set(t.addData.form,"role",e)},expression:"addData.form.role"}})],1)],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.subAdd()}}},[t._v("添 加")])],1)],1),a("el-dialog",{attrs:{title:"编辑",visible:t.editData.show,center:"",width:"420px","close-on-click-modal":!1},on:{"update:visible":function(e){return t.$set(t.editData,"show",e)}}},[a("el-form",{attrs:{model:t.editData.form,"label-width":t.LabelWidth}},[a("el-form-item",{attrs:{label:"名称"}},[a("el-input",{attrs:{placeholder:"角色名称"},model:{value:t.editData.form.role,callback:function(e){t.$set(t.editData.form,"role",e)},expression:"editData.form.role"}})],1)],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.subEdit()}}},[t._v("保 存")])],1)],1),a("el-dialog",{attrs:{title:"删除",visible:t.delData.show,center:"",width:"320px"},on:{"update:visible":function(e){return t.$set(t.delData,"show",e)}}},[a("div",[t._v("是否删除已选择数据？")]),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.subDel()}}},[t._v("彻底删除")])],1)]),a("el-dialog",{attrs:{title:"编辑权限",visible:t.permData.show,center:"",width:"480px","close-on-click-modal":!1},on:{"update:visible":function(e){return t.$set(t.permData,"show",e)}}},[a("el-tree",{ref:"perm",attrs:{data:t.permData.form,"show-checkbox":"","default-checked-keys":t.permData.default,"node-key":"id"}}),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.subPerm()}}},[t._v("更新")])],1)],1)],1)},i=[],r=(a("28a5"),a("e563")),s=a("919a"),l=a("8a2a"),n=a("775b"),d=a("58fd"),c={components:{Action:d["a"]},data:function(){return{LabelWidth:"80px",selectData:[],pageData:{list:[],total:0,page:1,limit:15},seaData:{show:!1,form:{role:""}},addData:{show:!1,form:{role:""}},editData:{show:!1,form:{role:""}},delData:{show:!1,id:""},permData:{show:!1,id:"",default:[""],form:[]},aMenus:[]}},computed:{actionType:function(){var t=this.$store.state.action.type;if("list"==t)this.seaData.form={role:""},this.pageData.page=1,this.loadData();else if("sea"==t)this.seaData.show=!0;else if("add"==t)this.addData.show=!0;else if("edit"==t){if(!(this.selectData.length>0))return Object(r["a"])("请选择数据!");this.getEdit({id:"",role:""})}else if("del"==t){if(!(this.selectData.length>0))return Object(r["a"])("请选择数据!");this.delData.show=!0;for(var e=this.selectData,a="",o=0;o<e.length;o++)a+=e[o].id+",";this.delData.id=a}return t}},mounted:function(){this.$store.state.action.url="SysRole",this.$store.state.action.menus="",this.loadData(),this.allAction()},methods:{page:function(t){this.pageData.page=t,this.loadData()},getSelect:function(t){this.selectData=t},loadData:function(){var t=this,e=Object(s["a"])();Object(l["a"])("Sysrole/list",{token:n["a"].getItem("token"),page:this.pageData.page,limit:this.pageData.limit,data:JSON.stringify(this.seaData.form)},(function(a){e.clear();var o=a.data;if(0!=o.code)return Object(r["a"])(o.msg);t.pageData.list=o.list,t.pageData.total=o.total}))},subSea:function(){this.seaData.show=!1,this.pageData.page=1,this.loadData()},subAdd:function(){var t=this;this.addData.show=!1;var e=Object(s["a"])();Object(l["a"])("Sysrole/add",{token:n["a"].getItem("token"),data:JSON.stringify(this.addData.form)},(function(a){e.clear();var o=a.data;return 0===o.code&&t.loadData(),Object(r["a"])(o.msg)}))},getEdit:function(t){for(var e in this.editData.show=!0,t)this.editData.form[e]=this.selectData[0][e]||""},subEdit:function(){var t=this;this.editData.show=!1;var e=Object(s["a"])();Object(l["a"])("Sysrole/edit",{token:n["a"].getItem("token"),id:this.editData.form.id,data:JSON.stringify(this.editData.form)},(function(a){e.clear();var o=a.data;return 0===o.code&&t.loadData(),Object(r["a"])(o.msg)}))},subDel:function(){var t=this;this.delData.show=!1;var e=Object(s["a"])();Object(l["a"])("Sysrole/del",{token:n["a"].getItem("token"),data:this.delData.id},(function(a){e.clear();var o=a.data;return 0===o.code&&t.loadData(),Object(r["a"])(o.msg)}))},allAction:function(){var t=this;Object(l["a"])("Usermain/getActionAll",{token:n["a"].getItem("token")},(function(e){var a=e.data;if(0!==a.code)return Object(r["a"])(a.msg);t.aMenus=a.aMenus}))},eidtPerm:function(t,e){var a=this;this.permData.id=t;var o=Object(s["a"])();Object(l["a"])("Sysrole/allMenus",{token:n["a"].getItem("token")},(function(t){o.clear();var i=t.data;if(0!==i.code)return Object(r["a"])(i.msg);if(a.permData.show=!0,a.permData.form=i.menus,e){for(var s=[],l=[],n=e.split(" "),d=[],c=0;c<n.length;c++)for(var u in d=n[c].split(":"),e=parseInt(d[1]),a.aMenus)e&parseInt(a.aMenus[u].perm)&&s.push(d[0]+":"+a.aMenus[u].perm);for(var f in s)l.push(i.id[s[f]]);setTimeout((function(){a.$refs.perm.setCheckedKeys(l)}),300)}}))},subPerm:function(){var t=this,e=this.$refs.perm.getCheckedKeys(),a=[],o=[],i=[],d={},c="";for(var u in e){for(var f in a=e[u].split(","),o=a[0].split("-"),o)d[o[f]]=0;i=a[1].split(":"),d[i[0]]=d[i[0]]?d[i[0]]+parseInt(i[1]):parseInt(i[1])}for(var p in d)c+=p+":"+d[p]+" ";this.permData.show=!1;var m=Object(s["a"])();Object(l["a"])("Sysrole/perm",{token:n["a"].getItem("token"),id:this.permData.id,perm:c},(function(e){m.clear();var a=e.data;return 0===a.code&&t.loadData(),Object(r["a"])(a.msg)}))}}},u=c,f=a("2877"),p=Object(f["a"])(u,o,i,!1,null,"7d7caa15",null);e["default"]=p.exports}}]);