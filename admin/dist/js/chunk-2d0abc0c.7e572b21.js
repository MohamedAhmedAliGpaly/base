(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0abc0c"],{"172b":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-input",{staticClass:"hide",model:{value:t.actionType,callback:function(e){t.actionType=e},expression:"actionType"}}),a("el-row",{staticClass:"body"},[a("el-table",{attrs:{data:t.pageData.list,stripe:""},on:{"selection-change":t.getSelect}},[a("el-table-column",{attrs:{type:"selection",width:"45"}}),a("el-table-column",{attrs:{prop:"uid",label:"UID",width:"170"}}),a("el-table-column",{attrs:{label:"个人信息",width:"160"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-popover",{attrs:{trigger:"hover",placement:"top"}},[a("p",[t._v("职务: "+t._s(e.row.position||"无"))]),a("p",[t._v("昵称: "+t._s(e.row.nickname||"无"))]),a("p",[t._v("姓名: "+t._s(e.row.name||"无"))]),a("p",[t._v("性别: "+t._s(e.row.gender||"无"))]),a("p",[t._v("生日: "+t._s(e.row.birthday||"无"))]),a("p",[t._v("年龄: "+t._s(e.row.age||"")+"岁")]),a("div",{attrs:{slot:"reference"},slot:"reference"},[a("el-tag",{attrs:{size:"medium"}},[t._v(t._s(e.row.tel||e.row.email||e.row.uname))])],1)])]}}])}),a("el-table-column",{attrs:{label:"登录时间",width:"160"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-popover",{attrs:{trigger:"hover",placement:"top"}},[a("p",[t._v("注册: "+t._s(e.row.rtime||"无"))]),a("p",[t._v("修改: "+t._s(e.row.utime||"无"))]),a("p",[t._v("登录: "+t._s(e.row.ltime||"无"))]),a("div",{attrs:{slot:"reference"},slot:"reference"},[a("el-tag",{attrs:{size:"medium"}},[t._v(t._s(e.row.ltime||"无"))])],1)])]}}])}),a("el-table-column",{attrs:{label:"状态",width:"70"},scopedSlots:t._u([{key:"default",fn:function(e){return[1==e.row.state?a("el-tag",{attrs:{type:"success"}},[t._v("正常")]):a("el-tag",{attrs:{type:"danger"}},[t._v("禁用")])]}}])}),a("el-table-column",{attrs:{label:"后台",width:"70"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-switch",{attrs:{"inactive-color":"#CCC"},on:{change:function(a){return t.setState("admin",e.row)}},model:{value:e.row.state_admin,callback:function(a){t.$set(e.row,"state_admin",a)},expression:"scope.row.state_admin"}})]}}])}),a("el-table-column",{attrs:{label:"APP",width:"70"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-switch",{attrs:{"inactive-color":"#CCC"},on:{change:function(a){return t.setState("app",e.row)}},model:{value:e.row.state_app,callback:function(a){t.$set(e.row,"state_app",a)},expression:"scope.row.state_app"}})]}}])}),a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.perm?a("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(a){return t.eidtPerm(e.row.uid,e.row.perm,e.row.role)}}},[t._v("专属权限")]):a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){return t.eidtPerm(e.row.uid,e.row.perm,e.row.role)}}},[t._v("角色权限")])]}}])})],1)],1),a("el-row",{staticClass:"page"},[a("el-pagination",{attrs:{background:"",layout:"prev, pager, next, total",total:t.pageData.total,"current-page":t.pageData.page,"page-size":t.pageData.limit},on:{"current-change":t.page}})],1),a("el-dialog",{attrs:{title:"搜索",visible:t.seaData.show,center:"",width:"420px"},on:{"update:visible":function(e){return t.$set(t.seaData,"show",e)}}},[a("el-form",{attrs:{model:t.seaData.form,"label-width":t.LabelWidth}},[a("el-form-item",{attrs:{label:"账号"}},[a("el-input",{attrs:{placeholder:"用户名/手机号码/邮箱"},model:{value:t.seaData.form.uname,callback:function(e){t.$set(t.seaData.form,"uname",e)},expression:"seaData.form.uname"}})],1)],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.subSea()}}},[t._v("搜 索")])],1)],1),a("el-dialog",{attrs:{title:"添加",visible:t.addData.show,center:"",width:"420px","close-on-click-modal":!1},on:{"update:visible":function(e){return t.$set(t.addData,"show",e)}}},[a("el-form",{attrs:{model:t.addData.form,"label-width":t.LabelWidth}},[a("el-form-item",{attrs:{label:"手机"}},[a("el-input",{attrs:{maxlength:"11",placeholder:"输入手机号码"},model:{value:t.addData.form.tel,callback:function(e){t.$set(t.addData.form,"tel",e)},expression:"addData.form.tel"}})],1),a("el-form-item",{attrs:{label:"密码"}},[a("el-input",{attrs:{maxlength:"16",placeholder:"默认密码"},model:{value:t.addData.form.passwd,callback:function(e){t.$set(t.addData.form,"passwd",e)},expression:"addData.form.passwd"}})],1)],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.subAdd()}}},[t._v("添 加")])],1)],1),a("el-dialog",{attrs:{title:"编辑",visible:t.editData.show,center:"",width:"420px","close-on-click-modal":!1},on:{"update:visible":function(e){return t.$set(t.editData,"show",e)}}},[a("el-form",{attrs:{model:t.editData.form,"label-width":t.LabelWidth}},[a("el-form-item",{attrs:{label:"手机"}},[a("el-input",{attrs:{maxlength:"11",placeholder:"输入手机号码"},model:{value:t.editData.form.tel,callback:function(e){t.$set(t.editData.form,"tel",e)},expression:"editData.form.tel"}})],1),a("el-form-item",{attrs:{label:"密码"}},[a("el-input",{attrs:{maxlength:"16",placeholder:"重置密码"},model:{value:t.editData.form.passwd,callback:function(e){t.$set(t.editData.form,"passwd",e)},expression:"editData.form.passwd"}})],1)],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.subEdit()}}},[t._v("保 存")])],1)],1),a("el-dialog",{attrs:{title:"删除",visible:t.delData.show,center:"",width:"320px"},on:{"update:visible":function(e){return t.$set(t.delData,"show",e)}}},[a("div",[t._v("是否删除已选择数据？")]),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.subDel()}}},[t._v("彻底删除")])],1)]),a("el-dialog",{attrs:{title:"编辑权限",visible:t.permData.show,center:"",width:"480px","close-on-click-modal":!1},on:{"update:visible":function(e){return t.$set(t.permData,"show",e)}}},[a("el-tabs",{model:{value:t.permData.active,callback:function(e){t.$set(t.permData,"active",e)},expression:"permData.active"}},[a("el-tab-pane",{attrs:{label:"专属权限",name:"one"}},[a("el-tree",{ref:"perm",attrs:{data:t.permData.form,"show-checkbox":"","default-checked-keys":t.permData.default,"node-key":"id"}})],1),a("el-tab-pane",{attrs:{label:"角色权限",name:"two"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择角色权限",clearable:"",filterable:""},model:{value:t.permData.role,callback:function(e){t.$set(t.permData,"role",e)},expression:"permData.role"}},t._l(t.userRole,(function(e){return a("el-option",{key:e.id,attrs:{label:e.role,value:e.id}},[a("span",{staticClass:"select_left"},[t._v(t._s(e.role))]),a("span",{staticClass:"select_right"},[t._v(t._s(e.id))])])})),1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.subPerm()}}},[t._v("更新")])],1)],1)],1)},r=[],o=(a("28a5"),a("e563")),l=a("919a"),i=a("8a2a"),n=a("775b"),c=a("58fd"),d={components:{Action:c["a"]},data:function(){return{LabelWidth:"80px",selectData:[],pageData:{list:[],total:0,page:1,limit:15},seaData:{show:!1,form:{uname:""}},addData:{show:!1,form:{tel:"",passwd:""}},editData:{show:!1,form:{tel:"",passwd:""}},delData:{show:!1,id:""},permData:{show:!1,active:"one",uid:"",default:[""],form:[],role:""},aMenus:[],userRole:[]}},computed:{actionType:function(){var t=this.$store.state.action.type;if("list"==t)this.seaData.form={role:""},this.pageData.page=1,this.loadData();else if("sea"==t)this.seaData.show=!0;else if("add"==t)this.addData.show=!0;else if("edit"==t){if(!(this.selectData.length>0))return Object(o["a"])("请选择数据!");this.getEdit({uid:"",tel:"",passwd:""})}else if("del"==t){if(!(this.selectData.length>0))return Object(o["a"])("请选择数据!");this.delData.show=!0;for(var e=this.selectData,a="",s=0;s<e.length;s++)a+=e[s].uid+",";this.delData.id=a}return t}},mounted:function(){this.$store.state.action.url="SysPerm",this.$store.state.action.menus="",this.loadData(),this.allAction()},methods:{page:function(t){this.pageData.page=t,this.loadData()},getSelect:function(t){this.selectData=t},loadData:function(){var t=this,e=Object(l["a"])();Object(i["a"])("Sysperm/list",{token:n["a"].getItem("token"),page:this.pageData.page,limit:this.pageData.limit,data:JSON.stringify(this.seaData.form)},(function(a){e.clear();var s=a.data;if(0!=s.code)return Object(o["a"])(s.msg);t.pageData.list=s.list,t.pageData.total=s.total})),this.setClass()},subSea:function(){this.seaData.show=!1,this.pageData.page=1,this.loadData()},subAdd:function(){var t=this;this.addData.show=!1;var e=JSON.stringify(this.addData.form),a=Object(l["a"])();Object(i["a"])("Sysperm/add",{token:n["a"].getItem("token"),data:e},(function(e){a.clear();var s=e.data;return 0===s.code&&t.loadData(),Object(o["a"])(s.msg)}))},getEdit:function(t){for(var e in this.editData.show=!0,t)this.editData.form[e]=this.selectData[0][e]||""},subEdit:function(){var t=this;this.editData.show=!1;var e=this.editData.form.uid,a=JSON.stringify(this.editData.form),s=Object(l["a"])();Object(i["a"])("Sysperm/edit",{token:n["a"].getItem("token"),uid:e,data:a},(function(e){s.clear();var a=e.data;return 0===a.code&&t.loadData(),Object(o["a"])(a.msg)}))},subDel:function(){var t=this;this.delData.show=!1;var e=Object(l["a"])();Object(i["a"])("Sysperm/del",{token:n["a"].getItem("token"),data:this.delData.id},(function(a){e.clear();var s=a.data;return 0===s.code&&t.loadData(),Object(o["a"])(s.msg)}))},setState:function(t,e){var a=e["state_"+t]?1:0,s=Object(l["a"])();Object(i["a"])("Sysperm/state/"+t,{token:n["a"].getItem("token"),uid:e.uid,state:a},(function(t){s.clear();var e=t.data;return Object(o["a"])(e.msg)}))},setClass:function(){var t=this;this.getClass("userRole",(function(e){t.userRole=e.data.list}))},getClass:function(t,e){Object(i["a"])("Sysperm/getClass/"+t,{token:n["a"].getItem("token")},e)},allAction:function(){var t=this;Object(i["a"])("Usermain/getActionAll",{token:n["a"].getItem("token")},(function(e){var a=e.data;if(0!==a.code)return Object(o["a"])(a.msg);t.aMenus=a.aMenus}))},eidtPerm:function(t,e,a){var s=this;this.permData.uid=t,this.permData.role=a||"";var r=Object(l["a"])();Object(i["a"])("Sysperm/allMenus",{token:n["a"].getItem("token")},(function(t){r.clear();var a=t.data;if(0!==a.code)return Object(o["a"])(a.msg);s.permData.show=!0,s.permData.form=a.menus;var l=[],i=[];if(e)for(var n=e.split(" "),c=[],d=0;d<n.length;d++)for(var u in c=n[d].split(":"),e=parseInt(c[1]),s.aMenus)e&parseInt(s.aMenus[u].perm)&&l.push(c[0]+":"+s.aMenus[u].perm);for(var p in l)i.push(a.id[l[p]]);setTimeout((function(){s.$refs.perm.setCheckedKeys(i)}),300)}))},subPerm:function(){var t=this,e=this.$refs.perm.getCheckedKeys(),a=[],s=[],r=[],c={},d="";for(var u in e){for(var p in a=e[u].split(","),s=a[0].split("-"),s)c[s[p]]=0;r=a[1].split(":"),c[r[0]]=c[r[0]]?c[r[0]]+parseInt(r[1]):parseInt(r[1])}for(var m in c)d+=m+":"+c[m]+" ";this.permData.show=!1;var f=Object(l["a"])();Object(i["a"])("Sysperm/perm",{token:n["a"].getItem("token"),uid:this.permData.uid,perm:d,role:this.permData.role},(function(e){f.clear();var a=e.data;return 0===a.code&&t.loadData(),Object(o["a"])(a.msg)}))}}},u=d,p=a("2877"),m=Object(p["a"])(u,s,r,!1,null,"289d0f0c",null);e["default"]=m.exports}}]);