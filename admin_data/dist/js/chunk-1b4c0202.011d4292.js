(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1b4c0202"],{"10e1":function(t,e,a){"use strict";a.r(e);var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("Action",{attrs:{url:"SysRole"},on:{action:t.openAction}}),a("el-row",{staticClass:"body"},[a("el-table",{attrs:{data:t.pageData.list,stripe:""},on:{"selection-change":t.getSelect}},[a("el-table-column",{attrs:{type:"selection",width:"45"}}),a("el-table-column",{attrs:{prop:"id",label:"ID",width:"50"}}),a("el-table-column",{attrs:{prop:"role",label:"名称",width:"180"}}),a("el-table-column",{attrs:{label:"更新时间",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n         "+t._s(e.row.utime||"空")+" \n        ")]}}])}),a("el-table-column",{attrs:{label:"操作","min-width":"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.perm?a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){return t.eidtPerm(e.row.id,e.row.perm)}}},[t._v("修改权限")]):a("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(a){return t.eidtPerm(e.row.id,e.row.perm)}}},[t._v("设置权限")])]}}])})],1)],1),a("el-row",{staticClass:"page"},[a("el-pagination",{attrs:{background:"",layout:"prev, pager, next, total",total:t.pageData.total,"current-page":t.pageData.page,"page-size":t.pageData.limit},on:{"current-change":t.page}})],1),a("el-dialog",{attrs:{title:"搜索",visible:t.seaData.show,center:"",width:"420px"},on:{"update:visible":function(e){return t.$set(t.seaData,"show",e)}}},[a("el-form",{attrs:{model:t.seaData.form,"label-width":t.LabelWidth}},[a("el-form-item",{attrs:{label:"名称"}},[a("el-input",{attrs:{placeholder:"角色名称"},model:{value:t.seaData.form.role,callback:function(e){t.$set(t.seaData.form,"role",e)},expression:"seaData.form.role"}})],1)],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.subSea()}}},[t._v("搜 索")])],1)],1),a("el-dialog",{attrs:{title:"添加",visible:t.addData.show,center:"",width:"420px"},on:{"update:visible":function(e){return t.$set(t.addData,"show",e)}}},[a("el-form",{attrs:{model:t.addData.form,"label-width":t.LabelWidth}},[a("el-form-item",{attrs:{label:"名称"}},[a("el-input",{attrs:{placeholder:"角色名称"},model:{value:t.addData.form.role,callback:function(e){t.$set(t.addData.form,"role",e)},expression:"addData.form.role"}})],1)],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.subAdd()}}},[t._v("添 加")])],1)],1),a("el-dialog",{attrs:{title:"编辑",visible:t.editData.show,center:"",width:"420px"},on:{"update:visible":function(e){return t.$set(t.editData,"show",e)}}},[a("el-form",{attrs:{model:t.editData.form,"label-width":t.LabelWidth}},[a("el-form-item",{attrs:{label:"名称"}},[a("el-input",{attrs:{placeholder:"角色名称"},model:{value:t.editData.form.role,callback:function(e){t.$set(t.editData.form,"role",e)},expression:"editData.form.role"}})],1)],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.subEdit()}}},[t._v("保 存")])],1)],1),a("el-dialog",{attrs:{title:"删除",visible:t.delData.show,center:"",width:"320px"},on:{"update:visible":function(e){return t.$set(t.delData,"show",e)}}},[a("div",[t._v("是否删除已选择数据？")]),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.subDel()}}},[t._v("彻底删除")])],1)]),a("el-dialog",{attrs:{title:"编辑权限",visible:t.permData.show,center:"",width:"480px","close-on-click-modal":!1},on:{"update:visible":function(e){return t.$set(t.permData,"show",e)}}},[a("el-tree",{ref:"perm",attrs:{data:t.permData.form,"show-checkbox":"","default-checked-keys":t.permData.default,"node-key":"id"}}),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.subPerm()}}},[t._v("更新")])],1)],1)],1)},i=[],r=(a("28a5"),a("7c2f")),s=a("58fd"),n={components:{Action:s["a"]},data:function(){return{LabelWidth:"80px",selectData:[],pageData:{list:[],total:0,page:1,limit:15},seaData:{show:!1,form:{role:""}},addData:{show:!1,form:{role:""}},editData:{show:!1,form:{role:""}},delData:{show:!1,id:""},permData:{show:!1,id:"",default:[""],form:[]},aMenus:[]}},mounted:function(){this.loadData(),this.allAction()},methods:{page:function(t){this.pageData.page=t,this.loadData()},getSelect:function(t){this.selectData=t},getEdit:function(t){if(this.selectData.length>0)for(var e in this.editData.show=!0,t)this.editData.form[e]=this.selectData[0][e]||"";else r["a"].toast("请选择数据!")},openAction:function(t){if("list"==t)this.seaData.form={role:""},this.pageData.page=1,this.loadData();else if("sea"==t)this.seaData.show=!0;else if("add"==t)this.addData.show=!0;else if("edit"==t)this.getEdit({id:"",role:""});else if("del"==t)if(this.selectData.length>0){this.delData.show=!0;for(var e=this.selectData,a="",o=0;o<e.length;o++)a+=e[o].id+",";this.delData.id=a}else r["a"].toast("请选择数据!")},loadData:function(){var t=this,e=r["a"].loading();r["a"].post("Sysrole/list",{token:r["a"].storage.getItem("token"),page:this.pageData.page,limit:this.pageData.limit,data:JSON.stringify(this.seaData.form)},(function(a){e.clear();var o=a.data;0!=o.code?r["a"].toast(o.msg,"error"):(t.pageData.list=o.list,t.pageData.total=o.total)}))},subSea:function(){this.seaData.show=!1,this.pageData.page=1,this.loadData()},subAdd:function(){var t=this;this.addData.show=!1;var e=r["a"].loading();r["a"].post("Sysrole/add",{token:r["a"].storage.getItem("token"),data:JSON.stringify(this.addData.form)},(function(a){var o=a.data;0!==o.code?(e.clear(),r["a"].toast(o.msg,"error")):(r["a"].toast(o.msg,"success"),t.loadData())}))},subEdit:function(){var t=this;this.editData.show=!1;var e=r["a"].loading();r["a"].post("Sysrole/edit",{token:r["a"].storage.getItem("token"),id:this.editData.form.id,data:JSON.stringify(this.editData.form)},(function(a){var o=a.data;0!==o.code?(e.clear(),r["a"].toast(o.msg,"error")):(r["a"].toast(o.msg,"success"),t.loadData())}))},subDel:function(){var t=this;this.delData.show=!1;var e=r["a"].loading();r["a"].post("Sysrole/del",{token:r["a"].storage.getItem("token"),data:this.delData.id},(function(a){var o=a.data;0!==o.code?(e.clear(),r["a"].toast(o.msg,"error")):(r["a"].toast(o.msg,"success"),t.loadData())}))},allAction:function(){var t=this;r["a"].post("Usermain/getActionAll",{token:r["a"].storage.getItem("token")},(function(e){var a=e.data;0!==a.code?r["a"].toast(a.msg,"error"):t.aMenus=a.aMenus}))},eidtPerm:function(t,e){var a=this;this.permData.id=t;var o=r["a"].loading();r["a"].post("Sysrole/allMenus",{token:r["a"].storage.getItem("token")},(function(t){var i=t.data;if(o.clear(),0!==i.code)r["a"].toast(i.msg,"error");else{if(a.permData.show=!0,a.permData.form=i.menus,!e)return;for(var s=[],n=[],l=e.split(" "),c=[],d=0;d<l.length;d++)for(var u in c=l[d].split(":"),e=parseInt(c[1]),a.aMenus)e&parseInt(a.aMenus[u].perm)&&s.push(c[0]+":"+a.aMenus[u].perm);for(var f in s)n.push(i.id[s[f]]);setTimeout((function(){a.$refs.perm.setCheckedKeys(n)}),300)}}))},subPerm:function(){var t=this,e=this.$refs.perm.getCheckedKeys(),a=[],o=[],i=[],s={},n="";for(var l in e){for(var c in a=e[l].split(","),o=a[0].split("-"),o)s[o[c]]=0;i=a[1].split(":"),s[i[0]]=s[i[0]]?s[i[0]]+parseInt(i[1]):parseInt(i[1])}for(var d in s)n+=d+":"+s[d]+" ";this.permData.show=!1;var u=r["a"].loading();r["a"].post("Sysrole/perm",{token:r["a"].storage.getItem("token"),id:this.permData.id,perm:n},(function(e){var a=e.data;0!==a.code?(u.clear(),r["a"].toast(a.msg,"error")):(r["a"].toast(a.msg,"success"),t.loadData())}))}}},l=n,c=a("2877"),d=Object(c["a"])(l,o,i,!1,null,"46e47bf1",null);e["default"]=d.exports},"28a5":function(t,e,a){"use strict";var o=a("aae3"),i=a("cb7c"),r=a("ebd6"),s=a("0390"),n=a("9def"),l=a("5f1b"),c=a("520a"),d=a("79e5"),u=Math.min,f=[].push,p="split",h="length",m="lastIndex",g=4294967295,v=!d((function(){RegExp(g,"y")}));a("214f")("split",2,(function(t,e,a,d){var D;return D="c"=="abbc"[p](/(b)*/)[1]||4!="test"[p](/(?:)/,-1)[h]||2!="ab"[p](/(?:ab)*/)[h]||4!="."[p](/(.?)(.?)/)[h]||"."[p](/()()/)[h]>1||""[p](/.?/)[h]?function(t,e){var i=String(this);if(void 0===t&&0===e)return[];if(!o(t))return a.call(i,t,e);var r,s,n,l=[],d=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),u=0,p=void 0===e?g:e>>>0,v=new RegExp(t.source,d+"g");while(r=c.call(v,i)){if(s=v[m],s>u&&(l.push(i.slice(u,r.index)),r[h]>1&&r.index<i[h]&&f.apply(l,r.slice(1)),n=r[0][h],u=s,l[h]>=p))break;v[m]===r.index&&v[m]++}return u===i[h]?!n&&v.test("")||l.push(""):l.push(i.slice(u)),l[h]>p?l.slice(0,p):l}:"0"[p](void 0,0)[h]?function(t,e){return void 0===t&&0===e?[]:a.call(this,t,e)}:a,[function(a,o){var i=t(this),r=void 0==a?void 0:a[e];return void 0!==r?r.call(a,i,o):D.call(String(i),a,o)},function(t,e){var o=d(D,t,this,e,D!==a);if(o.done)return o.value;var c=i(t),f=String(this),p=r(c,RegExp),h=c.unicode,m=(c.ignoreCase?"i":"")+(c.multiline?"m":"")+(c.unicode?"u":"")+(v?"y":"g"),b=new p(v?c:"^(?:"+c.source+")",m),w=void 0===e?g:e>>>0;if(0===w)return[];if(0===f.length)return null===l(b,f)?[f]:[];var k=0,y=0,x=[];while(y<f.length){b.lastIndex=v?y:0;var S,_=l(b,v?f:f.slice(y));if(null===_||(S=u(n(b.lastIndex+(v?0:y)),f.length))===k)y=s(f,y,h);else{if(x.push(f.slice(k,y)),x.length===w)return x;for(var I=1;I<=_.length-1;I++)if(x.push(_[I]),x.length===w)return x;y=k=S}}return x.push(f.slice(k)),x}]}))},"58fd":function(t,e,a){"use strict";var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.actions.length?a("el-row",{staticClass:"action"},[a("el-button-group",t._l(t.actions,(function(e){return a("el-button",{key:e.name,attrs:{icon:e.ico},on:{click:function(a){return t.openAction(e.action)}}},[t._v(t._s(e.name))])})),1)],1):t._e()},i=[],r=a("7c2f"),s={name:"ImageView",props:{url:{type:String,default:""}},data:function(){return{actions:[]}},mounted:function(){if(!this.url)return r["a"].toast("验证菜单不能为空!");this.getAction(this.url)},methods:{getAction:function(t){var e=this;r["a"].post("Usermain/getMenusAction",{token:r["a"].storage.getItem("token"),url:t},(function(t){var a=t.data;0==a.code&&(e.actions=a.menuAction)}))},openAction:function(t){this.$emit("action",t)}}},n=s,l=a("2877"),c=Object(l["a"])(n,o,i,!1,null,null,null);e["a"]=c.exports},aae3:function(t,e,a){var o=a("d3f4"),i=a("2d95"),r=a("2b4c")("match");t.exports=function(t){var e;return o(t)&&(void 0!==(e=t[r])?!!e:"RegExp"==i(t))}}}]);